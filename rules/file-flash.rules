# Copyright 2001-2015 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#------------------
# FILE-FLASH RULES
#------------------

alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malformed HTML text null dereference attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|92 D1 16 24 43 72 25 53 63 82 93 A2 C2 E1 F0 08|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3329; reference:url,www.adobe.com/support/security/bulletins/apsb13-14.html; classtype:attempted-user; sid:26688; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malformed HTML text null dereference attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|92 D1 16 24 43 72 25 53 63 82 93 A2 C2 E1 F0 08|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3329; reference:url,www.adobe.com/support/security/bulletins/apsb13-14.html; classtype:attempted-user; sid:26687; rev:4;)
alert tcp $EXTERNAL_NET 1935 -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player RTMP malformed onStatus message type confusion attempt"; flow:to_client,established; flowbits:isset,rtmp.flashver; content:"|02 00 08|onStatus|00|"; pcre:"/^.{9}[^\x03\x0a\x11\x10]/R"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service rtmp; reference:cve,2013-2555; reference:url,www.adobe.com/support/security/bulletins/apsb13-11.html; classtype:attempted-user; sid:26430; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1935 (msg:"FILE-FLASH Adobe Flash Player RTMP malformed onStatus message type confusion attempt"; flow:to_server,established; content:"|00 08|flashVer"; fast_pattern:only; flowbits:set,rtmp.flashver; flowbits:noalert; metadata:service rtmp; reference:cve,2013-2555; reference:url,www.adobe.com/support/security/bulletins/apsb13-11.html; classtype:attempted-user; sid:26429; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flashplayer sortOn heap overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|AF AC 5F 95 49 29 55 85 ED BD AA 20 D4 DE 76 B0 2B D0 11 9B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0646; reference:url,www.adobe.com/support/security/bulletins/apsb13-09.html; classtype:attempted-user; sid:26173; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flashplayer sortOn heap overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|AF AC 5F 95 49 29 55 85 ED BD AA 20 D4 DE 76 B0 2B D0 11 9B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0646; reference:url,www.adobe.com/support/security/bulletins/apsb13-09.html; classtype:attempted-user; sid:26172; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; file_data; content:"|33 0D 0A 43 57 53 0D 0A 31 0D 0A 0A 0D 0A 33 0D|"; content:"|0D 0A 34 0D 0A FE B3 6F 7D 0D 0A 33 0D 0A FC F1|"; within:16; distance:320; content:"|32 0D 0A F5 CB 0D 0A 33 0D 0A 4B 7C F1 0D 0A 34|"; within:16; distance:320; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:26112; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; file_data; content:"|64 BF B2 5C 3B 6C 01 CC 94 D8 86 75 E0 13 57 80|"; content:"|00 1C 84 81 C9 80 77 6F 72 6B 50 6F 73 5F 6D 63|"; within:16; distance:320; content:"|FD 8D AD 6D 92 AB 5A B5 AF EC 90 2F 1A 4C 2A 01|"; within:16; distance:320; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:26111; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|D7 F3 DB DF 19 6F DB FC E6 F7 5F CF 2F BF 99 BE|"; content:"|78 F9 BB 3F 7D FD 27 7C F9 FE AB F9 7A 7C E5 D3|"; within:16; distance:336; content:"|27 5F FD FC 7D 7D F7 FE 1F FC 7A 6B BF 7C 3F DF|"; within:16; distance:288; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:26110; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player SWF-based shellcode download attempt"; flow:to_server,established; file_data; content:"www.mypagex.com/fileshare/questions/"; fast_pattern:only; content:"explorer.exe"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26009; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SWF-based shellcode download attempt"; flow:to_client,established; file_data; content:"www.mypagex.com/fileshare/questions/"; fast_pattern:only; content:"explorer.exe"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26008; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_server,established; flowbits:isset,file.cws; file_data; content:"|43 57 53 0E BC 03 00 00 78 DA 5D 52 41 6F D3 30 14 B6 93 34|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26007; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_client,established; flowbits:isset,file.cws; file_data; content:"|43 57 53 0E BC 03 00 00 78 DA 5D 52 41 6F D3 30 14 B6 93 34|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26006; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_server,established; flowbits:isset,file.cws; file_data; content:"|43 57 53 0D A3 14 00 00 78 DA 75 37 69 73 1B 57 72 AF E7 7A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26005; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_client,established; flowbits:isset,file.cws; file_data; content:"|43 57 53 0D A3 14 00 00 78 DA 75 37 69 73 1B 57 72 AF E7 7A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26004; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_server,established; flowbits:isset,file.cws; file_data; content:"|43 57 53 0D B6 3A 00 00 78 DA 95 7B 09 60 54 C7 91 68 D7 7B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26003; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_client,established; flowbits:isset,file.cws; file_data; content:"|43 57 53 0D B6 3A 00 00 78 DA 95 7B 09 60 54 C7 91 68 D7 7B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26002; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_server,established; file_data; content:".LoadMovie"; content:"allowscriptaccess=|22|always|22|"; distance:0; content:"swLiveConnect=true"; distance:1; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26001; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player HTML & Javascript SWF use-after-free execution attempt"; flow:to_client,established; file_data; content:".LoadMovie"; content:"allowscriptaccess=|22|always|22|"; distance:0; content:"swLiveConnect=true"; distance:1; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,58186; reference:cve,2013-0648; reference:url,www.adobe.com/support/security/bulletins/apsb13-08.html; classtype:attempted-user; sid:26000; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript 3 integer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|02 61 30 02 61 31 02 61 32 02 61 33 02 61 34 02 61 35 02 61|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,49081; reference:cve,2011-2416; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:25835; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player FLV crafted ADPCM stream heap overflow attempt"; flow:to_server,established; flowbits:isset,file.flv; file_data; content:"|46 4C 56 01 05 00 00 00 09 00 00 00 00 09 00 02|"; depth:16; content:"|1D 25 00 00 08 42 10 84 21 08 42 10 84 21 08 42|"; within:16; distance:560; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57907; reference:cve,2013-0638; reference:url,www.adobe.com/support/security/bulletins/apsb13-05.html; classtype:attempted-user; sid:25816; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player FLV crafted ADPCM stream heap overflow attempt"; flow:to_client,established; flowbits:isset,file.flv; file_data; content:"|46 4C 56 01 05 00 00 00 09 00 00 00 00 09 00 02|"; depth:16; content:"|1D 25 00 00 08 42 10 84 21 08 42 10 84 21 08 42|"; within:16; distance:560; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57907; reference:cve,2013-0638; reference:url,www.adobe.com/support/security/bulletins/apsb13-05.html; classtype:attempted-user; sid:25815; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player nested SWF cross domain clickjacking attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|EA F8 BA 02 46 AE 74 67 BC 1D 25 61 41 B7 EB 8A B6 6F A2 46|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-0637; reference:url,www.adobe.com/support/security/bulletins/apsb13-05.html; classtype:attempted-recon; sid:25814; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player CFF FeatureCount integer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf.cff; file_data; content:"|00 7E 00 E2|"; content:"|00 01 00 00|"; within:4; distance:-10; byte_jump:2,0,relative,post_offset 2; byte_jump:2,0,relative,post_offset 2; content:"|FF FF|"; within:2; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0633; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:25683; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player CFF FeatureCount integer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf.cff; file_data; content:"|00 7E 00 E2|"; content:"|00 01 00 00|"; within:4; distance:-10; byte_jump:2,0,relative,post_offset 2; byte_jump:2,0,relative,post_offset 2; content:"|FF FF|"; within:2; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0633; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:25681; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_server,established; file_data; content:"|81 26 B3 45 C4 3F 7F 7F FF AE FD 47 3F 59 BA FD 67 FE ED D7 5E B5 55 6F 3D C2 B7 5E F9 00 BF FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:25679; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf|file.ole; content:"RegEx"; fast_pattern:only; pcre:"/RegExp?\x23.{0,5}\x28\x3f[^\x29]{0,4}i.*?\x28\x3f\x2d[^\x29]{0,4}i.{0,50}\x7c\x7c/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:25678; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_client,established; file_data; content:"|81 26 B3 45 C4 3F 7F 7F FF AE FD 47 3F 59 BA FD 67 FE ED D7 5E B5 55 6F 3D C2 B7 5E F9 00 BF FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:25677; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf|file.ole; content:"RegEx"; fast_pattern:only; pcre:"/RegExp?\x23.{0,5}\x28\x3f[^\x29]{0,4}i.*?\x28\x3f\x2d[^\x29]{0,4}i.{0,50}\x7c\x7c/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:25676; rev:5;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player DoInitAction invalid action overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|B6 0D 00 04 02 04 03 07 02 00 00 00 04 01 08 07|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5268; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24992; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player DoInitAction invalid action overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|B6 0D 00 04 02 04 03 07 02 00 00 00 04 01 08 07|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5268; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24991; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player specially invalid traits structure attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|09 0A 11 D0 30 5E A9 03 D1 68 A9 03 5D 8F 03 4F 8F 03 00 47 00 00 91 03 03 01 09 0A 1D D0 30 5E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5678; classtype:attempted-user; sid:24990; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player specially invalid traits structure attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|09 0A 11 D0 30 5E A9 03 D1 68 A9 03 5D 8F 03 4F 8F 03 00 47 00 00 91 03 03 01 09 0A 1D D0 30 5E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5678; classtype:attempted-user; sid:24989; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player index overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|31 33 31 59 CE FD 53 4A 77 B7 30 2C 90 35 63 A4 31 14 C9 76 C9 28 4A 21 55 EC 09 3A 26 62 E5 86|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5676; reference:url,www.adobe.com/support/security/bulletins/apsb12-XX.html; classtype:attempted-user; sid:24986; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player index overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|31 33 31 59 CE FD 53 4A 77 B7 30 2C 90 35 63 A4 31 14 C9 76 C9 28 4A 21 55 EC 09 3A 26 62 E5 86|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5676; reference:url,www.adobe.com/support/security/bulletins/apsb12-XX.html; classtype:attempted-user; sid:24985; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player loadPCMFromByteArray bad sample count attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"loadPCMFromByteArray"; fast_pattern:only; content:"|80 07 4F 13 01 62 05 20 82 13 04 00 00 10 0A 00|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5677; classtype:attempted-user; sid:24984; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player actionscript bytecode trait type null pointer dereference attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|1F 91 C2 5F AC B1 71 4A 7E 99 DA 93 EC A2 6D 53 DF 3C 39 97 4D 2C 1B BF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5266; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24983; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player actionscript bytecode trait type null pointer dereference attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|1F 91 C2 5F AC B1 71 4A 7E 99 DA 93 EC A2 6D 53 DF 3C 39 97 4D 2C 1B BF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5266; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24982; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player actionscript bytecode trait type null pointer dereference attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"FWS"; depth:3; content:"|03 00 00 00 00 00 00 00 00 00 00 00 00 00 01 02 03 09 06 00 01 01 01 03|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5266; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24981; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player actionscript bytecode trait type null pointer dereference attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"FWS"; depth:3; content:"|03 00 00 00 00 00 00 00 00 00 00 00 00 00 01 02 03 09 06 00 01 01 01 03|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5266; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24980; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript bytecode symbolclass tag type confusion attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|FF 01 2B 00 00 00 6C 00 01 00 8A 06 06 01 00 67 00 1B 36 1F C9 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5270; reference:url,adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24896; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript bytecode symbolclass tag type confusion attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|FF 01 2B 00 00 00 6C 00 01 00 8A 06 06 01 00 67 00 1B 36 1F C9 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5270; reference:url,adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24895; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Action InitArray stack overflow attempt"; flow:to_server, established; flowbits:isset,file.swf; file_data; content:"|96|"; content:"|07|"; within:1; distance:2; byte_test:4,>,0x040000,0,relative,little; byte_test:2,<,0xFF,-3,relative,little; byte_jump:2,-3,relative,little; content:"|42|"; within:1; metadata:service smtp; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24894; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Action InitArray stack overflow attempt"; flow:to_server, established; flowbits:isset, file.swf; file_data; content:"|96 05 00 07|"; byte_test:4,>,0x040000,0,relative,little; content:"|42|"; within:1; distance:4; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24893; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Action InitArray stack overflow attempt"; flow:to_server, established; flowbits:isset,file.swf; file_data; content:"|96|"; byte_jump:2,0,relative,little; content:"|42|"; within:1; content:"|07|"; within:1; distance:-6; byte_test:4,>,0x040000,0,relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24892; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player action InitArray stack overflow attempt"; flow:to_client, established; flowbits:isset,file.swf; file_data; content:"|96|"; content:"|07|"; within:1; distance:2; byte_test:4,>,0x040000,0,relative,little; byte_jump:2,-3,relative,little; content:"|42|"; within:1; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24891; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Action InitArray stack overflow attempt"; flow:to_client, established; flowbits:isset, file.swf; file_data; content:"|96 05 00 07|"; byte_test:4,>,0x040000,0,relative,little; content:"|42|"; within:1; distance:4; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24890; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Action InitArray stack overflow attempt"; flow:to_client, established; flowbits:isset,file.swf; file_data; content:"|96|"; byte_jump:2,0,relative,little; content:"|42|"; within:1; content:"|07|"; within:1; distance:-6; byte_test:4,>,0x040000,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24889; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player invalid JPEG index attempt"; flow:to_server,established; file_data; content:"FWS"; depth:3; content:"|FF E0 10 00|JFIF|00|"; content:"|FF DA 00 08 01|"; distance:0; byte_test:1,>,3,1,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5267; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24882; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player invalid JPEG index attempt"; flow:to_client,established; file_data; content:"FWS"; depth:3; content:"|FF E0 00 10|JFIF|00|"; distance:0; content:"|FF DA 00 08 01|"; distance:0; byte_test:1,>,3,1,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5267; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24879; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|01 09 0A 2E D0 30 D0 5D 04 4A 04 00 68 01 D0 94 90 4E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24877; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|01 09 0A 2E D0 30 D0 5D 04 4A 04 00 68 01 D0 94 90 4E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24876; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|01 09 0A 2E D0 30 D0 5D 04 4A 04 00 68 01 D0 92 90 4E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24875; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|01 09 0A 2E D0 30 D0 5D 04 4A 04 00 68 01 D0 92 90 4E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24874; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player AS2 privilege escalation attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|F5 69 1A 7D 8A 46 9F 5C 64 48 32 9B 52 CC DC 4E 35 EB F5 5F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5278; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24813; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player AS2 privilege escalation attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|F5 69 1A 7D 8A 46 9F 5C 64 48 32 9B 52 CC DC 4E 35 EB F5 5F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5278; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24812; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player AS2 privilege escalation attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|B9 6D 3D DC 78 02 AD 3D 79 F8 B8 79 79 00 09 E9 40 4F 6B 5B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5278; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24811; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player AS2 privilege escalation attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|B9 6D 3D DC 78 02 AD 3D 79 F8 B8 79 79 00 09 E9 40 4F 6B 5B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5278; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24810; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Microsoft Internet Explorer premature unload of Flash plugin use after free attempt"; flow:to_server,established; file_data; content:".innerHTML"; nocase; content:"embed src"; within:64; nocase; content:"swf"; within:32; nocase; pcre:"/\.innerHTML\s*=\s*[\x22\x27]\s*<\s*embed[^>]*?src=\\?[\x22\x27][^\x22\x27]*?\.swf\\?[\x22\x27]/ims"; content:".innerHTML"; distance:0; nocase; pcre:"/^\s*=\s*[\x22\x27]{2}\s*\;/R"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5272; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24809; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Microsoft Internet Explorer premature unload of Flash plugin use after free attempt"; flow:to_client,established; file_data; content:".innerHTML"; nocase; content:"embed src"; within:64; nocase; content:"swf"; within:32; nocase; pcre:"/\.innerHTML\s*=\s*[\x22\x27]\s*<\s*embed[^>]*?src=\\?[\x22\x27][^\x22\x27]*?\.swf\\?[\x22\x27]/ims"; content:".innerHTML"; distance:0; nocase; pcre:"/^\s*=\s*[\x22\x27]{2}\s*\;/R"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5272; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:24808; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"E9308C77A627681188C6AF05AC521652"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-01.html; classtype:attempted-user; sid:24688; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"E9308C77A627681188C6AF05AC521652"; fast_pattern:only; content:"Knockout-HTF50-Welterweight"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-01.html; classtype:attempted-user; sid:24687; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|1D 1D 1D 1D 1D 1D 1D 6D|"; content:"|00 00 01 02|"; within:4; distance:2; byte_extract:1,0,local_count,relative; content:"|D0 49 00|"; within:3; distance:3; content:"|94|"; distance:0; byte_test:1,!&,128,0,relative; byte_test:1,>,local_count,0,relative; content:"|47 00 00|"; distance:0; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24431; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|1D 1D 1D 1D 1D 1D 1D 6D|"; content:"|00 00 01 02|"; within:4; distance:2; byte_extract:1,0,local_count,relative; content:"|D0 49 00|"; within:3; distance:3; content:"|94|"; distance:0; byte_test:1,!&,128,0,relative; byte_test:1,>,local_count,0,relative; content:"|47 00 00|"; distance:0; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24430; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|1D 1D 1D 1D 1D 1D 1D 6D|"; content:"|00 00 01 02|"; within:4; distance:2; byte_extract:1,0,local_count,relative; content:"|D0 49 00|"; within:3; distance:3; content:"|92|"; distance:0; byte_test:1,!&,128,0,relative; byte_test:1,>,local_count,0,relative; content:"|47 00 00|"; distance:0; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24429; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|1D 1D 1D 1D 1D 1D 1D 6D|"; content:"|00 00 01 02|"; within:4; distance:2; byte_extract:1,0,local_count,relative; content:"|D0 49 00|"; within:3; distance:3; content:"|92|"; distance:0; byte_test:1,!&,128,0,relative; byte_test:1,>,local_count,0,relative; content:"|47 00 00|"; distance:0; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:24428; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player stsz box heap overflow attempt"; flow:to_server,established; flowbits:isset,file.drm.f4v; file_data; content:"stsz|00 00 00 00 00 00 00 00|"; byte_test:4,!=,0,0,relative; byte_test:4,=,0,4,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4167; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:attempted-user; sid:24415; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player stsz box heap overflow attempt"; flow:to_client,established; flowbits:isset,file.drm.f4v; file_data; content:"stsz|00 00 00 00 00 00 00 00|"; byte_test:4,!=,0,0,relative; byte_test:4,=,0,4,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4167; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:attempted-user; sid:24414; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player DRM encrypted file detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"sinf"; fast_pattern:only; flowbits:set,file.drm.f4v; flowbits:noalert; metadata:service smtp; classtype:misc-activity; sid:24413; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player DRM encrypted file detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"sinf"; fast_pattern:only; flowbits:set,file.drm.f4v; flowbits:noalert; metadata:service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:24412; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed record stack exhaustion attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|3F 08 E1 00 00 00 01 00 45 F2 25 F2 20 01 12 A9 12 44 80 02 00 FF FF FF FF FF FF FF FF 00 00 10 15 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4163; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:denial-of-service; sid:24367; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed record stack exhaustion attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|3F 08 E1 00 00 00 01 00 45 F2 25 F2 20 01 12 A9 12 44 80 02 00 FF FF FF FF FF FF FF FF 00 00 10 15 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4163; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:denial-of-service; sid:24366; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash null reference JIT compilation attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|09 0A BF 03 D0 30 20 80 06 D5 20 80 06 D6 60 64 66 09 80 06 D5 10 A3 01 00 09 D1 66 7E 80 06 D6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4165; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:denial-of-service; sid:24365; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash null reference JIT compilation attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|ED B6 DB 4D 85 68 66 57 89 24 CB 66 92 1D 34 FC 5C A0 CF 32 2A A2 54 46 3C B1 B5 4F 46 7C 26 0F|"; fast_pattern:only; isdataat:!624; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4165; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:denial-of-service; sid:24364; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash null reference JIT compilation attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|09 0A BF 03 D0 30 20 80 06 D5 20 80 06 D6 60 64 66 09 80 06 D5 10 A3 01 00 09 D1 66 7E 80 06 D6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4165; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:denial-of-service; sid:24363; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash null reference JIT compilation attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|ED B6 DB 4D 85 68 66 57 89 24 CB 66 92 1D 34 FC 5C A0 CF 32 2A A2 54 46 3C B1 B5 4F 46 7C 26 0F|"; fast_pattern:only; isdataat:!624; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4165; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:denial-of-service; sid:24362; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Matrix3D copyRawDataTo integer overflow attempt"; flow:to_server,established; file_data; content:"|A3 9D 7B C7 44 71 75 DD F0 26 8A 1F 78 66 64 50 4F 16 95 4A 8A EF 97 C4 12 7E 34 74 EC 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55691; reference:cve,2012-5054; reference:url,osvdb.org/show/osvdb/85786; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:attempted-user; sid:24245; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Matrix3D copyRawDataTo integer overflow attempt"; flow:to_client,established; file_data; content:"|A3 9D 7B C7 44 71 75 DD F0 26 8A 1F 78 66 64 50 4F 16 95 4A 8A EF 97 C4 12 7E 34 74 EC 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55691; reference:cve,2012-5054; reference:url,osvdb.org/show/osvdb/85786; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:attempted-user; sid:24244; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player object confusion attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|1E 3E 95 0F 29 8B 36 33 45 A4 1C F6 43 97 12 71 58 FF 44|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:attempted-user; sid:24142; rev:2;)
alert tcp $EXTERNAL_NET 1935 -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed RTMP response attempt"; flow:to_client,established; content:"|02 00 06|_error|00|"; isdataat:9,relative; content:!"|05|"; within:1; distance:8; content:!"|03|"; within:1; distance:8; metadata:policy balanced-ips drop, policy security-ips drop, service rtmp; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:protocol-command-decode; sid:24140; rev:4;)
alert tcp $EXTERNAL_NET 1935 -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed RTMP response attempt"; flow:to_client,established; content:"|02 00 06|_error|00|"; content:"|05|"; within:1; distance:8; byte_test:1,>,0x11,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service rtmp; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:protocol-command-decode; sid:24139; rev:7;)
alert tcp $EXTERNAL_NET 1935 -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed RTMP response attempt"; flow:to_client,established; content:"|02 00 06|_error|00|"; content:"|03|"; within:1; distance:8; byte_jump:2,0,relative; content:"|09|"; distance:0; isdataat:1,relative; content:!"|03|"; within:1; content:!"|05|"; within:1; metadata:policy balanced-ips drop, policy security-ips drop, service rtmp; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:protocol-command-decode; sid:24138; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|44 04 17 14 95 CB 8B 04 AF 15 74 5D D7 FB 64 5D|"; fast_pattern:only; content:"|FF 7B 55 93 A2 93 FF FE 77 F9 D0 DD EF 57 EF 5B|"; content:"|66 30 12 CE C6 06 B5 C6 48 C2 9C 36 6E 5C B2 D5|"; within:16; distance:96; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:23997; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|44 04 17 14 95 CB 8B 04 AF 15 74 5D D7 FB 64 5D|"; fast_pattern:only; content:"|FF 7B 55 93 A2 93 FF FE 77 F9 D0 DD EF 57 EF 5B|"; content:"|66 30 12 CE C6 06 B5 C6 48 C2 9C 36 6E 5C B2 D5|"; within:16; distance:96; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:23996; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash OpenType font memory corruption attempt - compressed"; flow:to_client,established; file_data; content:"|1D 27 2F 72 E1 98 12 1D 13 1E AA 63 66 F7 1F 53 A6 FF 5A 82 B6 31 57 6A F7 40 FB 43 CE 7D C7 0D 1F 64 7F 41 F2 D2 7B A6 C6 A0 DD 60 B4 6E 31 FF 07 50 9B 47 3E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55009; reference:cve,2012-1535; reference:url,www.adobe.com/support/security/bulletins/apsb12-18.html; classtype:attempted-user; sid:23967; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH string heapspray flash file - likely attack"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"heapspray"; fast_pattern:only; metadata:service smtp; classtype:attempted-user; sid:23856; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH string heapspray flash file - likely attack"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"heapspray"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:23855; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash OpenType font memory corruption attempt"; flow:to_server,established; file_data; content:"FWS"; content:"</rdf:RDF>"; distance:0; content:"kern"; within:500; byte_extract:4,4,kern_offset,relative; content:"OTTO"; byte_test:4,>=,0x10000000,kern_offset,relative; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55009; reference:cve,2012-1535; reference:url,www.adobe.com/support/security/bulletins/apsb12-18.html; classtype:attempted-user; sid:23854; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash OpenType font memory corruption attempt"; flow:to_client,established; file_data; content:"FWS"; content:"</rdf:RDF>"; distance:0; content:"kern"; within:500; byte_extract:4,4,kern_offset,relative; content:"OTTO"; byte_test:4,>=,0x10000000,kern_offset,relative; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55009; reference:cve,2012-1535; reference:url,www.adobe.com/support/security/bulletins/apsb12-18.html; classtype:attempted-user; sid:23853; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption exploit attempt"; flow:to_server,established; file_data; content:"CWS|09|"; content:"|3D BF CF FB CF 8B D6 E9 EE EA EA EA AA EA EA EA|"; within:16; distance:94; metadata:policy security-ips drop, service smtp; reference:cve,2010-0197; reference:cve,2010-1297; classtype:attempted-admin; sid:23592; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_server,established; file_data; content:"|D2 60 3B 40 C1 03 AB 12 E5 00 00 60 E8 03 24 00|"; content:"|46 FF 04 02 75 63 07 60 97 01 24 02 A1 62 04 0E|"; within:16; distance:16; metadata:policy security-ips drop, service smtp; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:23591; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash use-after-free attack attempt"; flow:to_server,established; file_data; content:"|53 68 68 68 20 64 6F 6E 27 74 20 74 65 6C 6C 20 61 6E 79 20 6F 6E 65 20 74 68 69 73 20 69 73 20 61 20 73 65 63 72 65 74 20 6B 65 79 21 16 54 68 65 20 74 72 75 74 68 20 69 73 20 6F 75 74 20 74 68 65 72 65 08 43 4F 4D 50 4C 45 54 45 0B 72 65 6D 6F 76 65 43 68 69 6C 64 0A 55 52 4C 52 65 71 75 65 73 74 30 68 74 74 70|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:cve,2010-1297; classtype:attempted-user; sid:23579; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_server,established; file_data; content:"|93 1A|FirstCircleBBBBBBBBBBBBBBBBBBBBBBB|06 A6 17 30|BBBBBBBBBBBBBBBBBBBB|90 90 90 90|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:23265; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_client,established; file_data; content:"|93 1A|FirstCircleBBBBBBBBBBBBBBBBBBBBBBB|06 A6 17 30|BBBBBBBBBBBBBBBBBBBB|90 90 90 90|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:23264; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player flash.DisplayObject memory corruption attempt"; flow:established,to_client; flowbits:isset,file.swf; file_data; content:"flash.display|3A|DisplayObject|24|"; fast_pattern:only; content:"addChild"; content:"removed"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2034; reference:url,www.adobe.com/support/security/bulletins/apsb12-14.html; classtype:misc-attack; sid:23135; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player broker destructor DoS attempt"; flow:to_client,established; file_data; content:"D27CDB6E-AE6D-11CF-96B8-444553540000"; fast_pattern:only; content:"document.onkeypress"; nocase; pcre:"/var\s+(\w+)\s*=\s*\x27document[^\=]*?=\x5c\x27<object[^>]*?>\s*?<param\s+name=\x22movie\x22\s+value=\x22[^\.]*?\.swf[^\}]*?eval\(\1\)/i"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2012-2035; reference:url,adobe.com/support/security/bulletins/apsb12-14.html; classtype:attempted-dos; sid:23134; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player flash.display.BitmapData constuctor overflow attempt"; flow:established,to_client; flowbits:isset,file.swf; file_data; content:"flash.display"; content:"BitmapData"; distance:0; content:"|30 D0 49 00 5D 03 24 10|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2036; reference:url,www.adobe.com/support/security/bulletins/apsb12-14.html; classtype:misc-attack; sid:23133; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player DefineSound tag long recordheader length field attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|BF 03 00 EE FF 7F 0F 00 26 37 02 00 00 61 06 FF E3 20 C0 00 00 00 02 58|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2037; reference:url,www.adobe.com/support/security/bulletins/apsb12-14.html; classtype:attempted-user; sid:23132; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player X500 DistinguishedName property access attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|6B 3E 35 2F D7 02 D4 F0 88 41 EB 67 C7 D7 4F A8 56 8C D8 A7 C4 A5 AE AD E9 15 CF AE F7 E0 74 47|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2039; reference:url,www.adobe.com/support/security/bulletins/apsb12-14.html; classtype:attempted-user; sid:23131; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player X509 direct instantiation property access attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|2F 65 54 07 41 6C AD 12 37 3E 1A 37 A0 D9 F7 60 1F 29 07 AF FD D8 AD ED D7 08 31 52 76 8A 43 A8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2039; reference:url,www.adobe.com/support/security/bulletins/apsb12-14.html; classtype:attempted-user; sid:23130; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SecureSocket use without Connect attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|3A 58 E6 FB 74 80 30 B8 BF 2C 54 5B F9 4D C8 B2 AB BA 3D 56 1C 6C F7 3D 9D D6 34 A0 52 7E F2 6A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2039; reference:url,www.adobe.com/support/security/bulletins/apsb12-14.html; classtype:attempted-user; sid:23129; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player object confusion attempt"; flow:to_client,established; file_data; content:"|E2 41 76 26 4F 70 65 72 61 74 65 64 20 62 79 20 44 6F 53 57 46|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:attempted-user; sid:22916; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player object confusion attempt"; flow:to_client,established; file_data; content:"|74 F2 37 35 34 31 32 32 37 8C 4C 8C A3 B1 E3 E8 F0 22 70 3A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:attempted-user; sid:22915; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player object confusion attempt"; flow:to_client,established; file_data; content:"|FF 0F AA 70 2A B7 17 2A C1 3B 77 35 50 B9 6B 07 17 16 1D 92|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:attempted-user; sid:22070; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player object confusion attempt"; flow:to_client,established; file_data; content:"|11 B3 38 36 87 2D C0 BB 20 72 7C 49 54 35 83 87 FA C3 48 10|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0779; reference:url,www.adobe.com/support/security/bulletins/apsb12-09.html; classtype:attempted-user; sid:22069; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Video invalid tag type attempt"; flow:to_client,established; flowbits:isset,file.flv; file_data; content:"FLV|01|"; depth:4; content:"|00 00 00 00 17|"; within:5; distance:5; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips alert, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0773; classtype:attempted-user; sid:21655; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Video invalid tag type attempt"; flow:to_client,established; file_data; content:"|FB 1A BD E9 6B F4 AE 37 BD 71 2F FA 02 BD EA 6D 5F A0 F4 8C 9D 06 A8 7A 55 CB F6 CC 39 E7 3B DF 9C 3F 7B 8A A4 DF 11 2A FE 88 50 1D A3 CE C2 32 42 E8 BB CA 2F 18 A1 DD D0 1E EC BC EE 1C 36 A6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0773; classtype:attempted-user; sid:21654; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Flash ActionScript getURL target null reference attempt"; flow:to_server,established; content:".swf?"; nocase; http_uri; content:"&TARGET="; within:20; nocase; http_uri; pcre:"/\x26TARGET\x3d\x5f(blank|parent|top)/Usi"; content:"&REDIR=javascript"; distance:0; nocase; http_uri; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy security-ips drop, service http; reference:cve,2012-0772; reference:url,adobe.com/support/security/bulletins/apsb12-07.html; classtype:denial-of-service; sid:21653; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Actionscript Stage3D null dereference attempt"; flow:to_client,established; file_data; content:"import flash.geom"; fast_pattern:only; content:"new"; nocase; content:"Stage3D()"; within:20; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0768; reference:url,www.adobe.com/support/security/bulletins/apsb12-05.html; classtype:attempted-user; sid:21536; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Actionscript Matrix3D.copyRawDataFrom buffer overflow attempt"; flow:to_client,established; file_data; content:"|A3 96 56 6C 5B B4 87 59 19 DB B6 A1 6B D8 B5 53 46 59 A7 6B 69 27 43 3C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0768; reference:url,www.adobe.com/support/security/bulletins/apsb12-05.html; classtype:attempted-user; sid:21535; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Actionscript Matrix3D.copyRawDataFrom buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"RawDataFrom(new Vector.<Number>(), 0x41414141"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0768; reference:url,www.adobe.com/support/security/bulletins/apsb12-05.html; classtype:attempted-user; sid:21534; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Actionscript Stage3D null dereference attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|7D B3 D7 78 DB 3A 2A 4D 86 B6 13 34 B8 B5 57 1E 30 E6 35 54 75 3C 1E 57|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0768; reference:url,www.adobe.com/support/security/bulletins/apsb12-05.html; classtype:attempted-user; sid:21533; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player action script 3 bitmap malicious rectangle attempt"; flow:to_client,established; file_data; content:"bitmap.histogram|28|new Rectangle|28|"; nocase; content:!"-"; within:3; byte_test:8,>=,0x40000000,0,relative,string; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,52299; reference:cve,2012-0769; reference:url,adobe.com/support/security/bulletins/apsb12-05.html; classtype:attempted-user; sid:21532; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player action script 3 bitmap malicious rectangle attempt"; flow:to_client,established; file_data; content:"bitmap.histogram|28|new Rectangle|28|"; nocase; content:"-"; within:3; byte_test:8,<=,0x40000000,0,relative,string; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,52299; reference:cve,2012-0769; reference:url,adobe.com/support/security/bulletins/apsb12-05.html; classtype:attempted-user; sid:21531; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player action script 3 bitmap malicious rectangle attempt"; flow:to_client,established; file_data; content:"|43 57 53 0E 93 03 00 00 78 DA 5D 52 CB 6E D3 40 14 BD 33 76 EC D8 7D AB 28 2A 0B 24 4B 45 8A 54 91 D8 49 61 D1 28 B5 28 75 83 DA 05 95 CA 06 55|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,52299; reference:cve,2012-0769; reference:url,adobe.com/support/security/bulletins/apsb12-05.html; classtype:attempted-user; sid:21530; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption"; flow:to_server,established; file_data; content:"|0B 6F 21 00 00 78 9C ED 59 7D 6C 1B C7 95 9F 59|"; depth:16; offset:3; content:"|9A 85 C1 70 78 7E 7E BE 6B BE BB 4B D3 67 C2 91|"; within:16; distance:160; content:"|B1 1B 88 2D BA F6 4C 5B 75 82 9A 52 46 32 A5 2D|"; within:16; distance:144; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:21458; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption"; flow:to_client,established; file_data; content:"|77 3C F6 F5 23 0F E7 BD 49 F6 E1 DD 38 E4 41 1C|"; depth:16; offset:18; content:"|A7 15 35 3B 00 AB 23 1D 29 C3 C8 0C 04 83 F3 F3|"; within:16; distance:128; content:"|9A 9E 16 8C 21 21 93 51 64 51 60 E6 82 F9 40 36|"; within:16; distance:80; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:21457; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player MP4 zero length atom attempt"; flow:to_client,established; file_data; content:"|4E 65 74 53 74 72 65 61 6D 09 72 65 70 72 6F 2E 6D 70 34 04 70 6C 61 79 0E 61 64 64 46 72 61 6D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0754; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21338; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ASConstructor insecure calling attempt"; flow:to_client,established; file_data; content:"|83 E3 E3 B6 37 E6 3A B3 C7 AA 56 19 5D 3A 63 B9 59 67 DA 1E 44 C1 8B 16 4C BA 94 26 03 21 AF 0E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0753; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21336; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript bytecode type confusion null dereference attempt"; flow:to_client,established; file_data; content:"|A3 5E D6 FD 5B F4 25 97 57 C3 FE 17 42 A7 C5 3D CA 49 8E 9E 3B 73 FE F4 58 7B 2C 3A 4A 6E 8B C7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0752; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21335; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActiveX URL import attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"FWS"; depth:3; byte_test:1,<,8,0,relative; byte_test:1,>,0,0,relative; content:"D|0E 3F|"; distance:0; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0751; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21326; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player cross site request forgery attempt"; flow:to_client,established; file_data; content:"|49 6E 69 74 00 74 61 72 67 65 74 00 6A 61 76 61 73 63 72 69 70 74|"; fast_pattern:only; content:"|00 67 65 74 55 52 4C 00|"; nocase; content:"|02 00 00 00 08 09 1C 96 02 00 08 0A 52 3C 96 0D|"; distance:0; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-0767; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21325; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Acrobat Flash Player uxtheme.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|uxtheme.dll"; nocase; http_uri; content:!"User-Agent: Microsoft-Symbol-Server/"; http_header; metadata:service http; reference:cve,2012-0756; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21324; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Acrobat Flash Player atl.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|atl.dll"; nocase; http_uri; content:!"User-Agent: Microsoft-Symbol-Server/"; http_header; metadata:service http; reference:cve,2012-0756; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21323; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Acrobat Flash Player version.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|version.dll"; nocase; http_uri; content:!"User-Agent: Microsoft-Symbol-Server/"; http_header; metadata:service http; reference:cve,2012-0756; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21322; rev:6;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-FLASH Adobe Acrobat Flash Player uxtheme.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"u|00|x|00|t|00|h|00|e|00|m|00|e|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-0756; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21321; rev:5;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-FLASH Adobe Acrobat Flash Player atl.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"a|00|t|00|l|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-0756; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21320; rev:5;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-FLASH Adobe Acrobat Flash Player version.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"v|00|e|00|r|00|s|00|i|00|o|00|n|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-0756; reference:url,www.adobe.com/support/security/bulletins/apsb12-03.html; classtype:attempted-user; sid:21319; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_server,established; file_data; content:"|01 00 00 00 08 1C 99 02 00 C4 FE 96 05 00 07 0C F5 4E 15 4C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20803; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_server,established; file_data; content:"charAt|08|parseInt|09|writeByte|05|Array"; content:"4657530ACC0500007800055F00000FA000001801004"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20785; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt - namelist.xls"; flow:to_server,established; file_data; content:"Q1dTCswFAAB4nE1UbWxTZRQ+t73t+3btKN0YnawgU"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20784; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt - dear chu.rar"; flow:to_server,established; file_data; content:"Rar!"; content:"dear chu.doc"; within:12; distance:48; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20783; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt - economy.rar"; flow:to_server,established; file_data; content:"Rar!"; content:"Economy.doc"; within:11; distance:48; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20782; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_client,established; file_data; content:"charAt|08|parseInt|09|writeByte|05|Array"; content:"4657530ACC0500007800055F00000FA000001801004"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20781; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt - namelist.xls"; flow:to_client,established; file_data; content:"Q1dTCswFAAB4nE1UbWxTZRQ+t73t+3btKN0YnawgU"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20780; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt - dear chu.rar"; flow:to_client,established; file_data; content:"Rar!"; content:"dear chu.doc"; within:12; distance:48; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20779; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt - economy.rar"; flow:to_client,established; file_data; content:"Rar!"; content:"Economy.doc"; within:11; distance:48; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20778; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption attempt"; flow:to_client,established; file_data; content:"|77 3C F6 F5 23 0F E7 BD 49 F6 E1 DD 38 E4 41 1C|"; depth:16; offset:18; content:"|A7 15 35 3B 00 AB 23 1D 29 C3 C8 0C 04 83 F3 F3|"; within:16; distance:128; content:"|9A 9E 16 8C 21 21 93 51 64 51 60 E6 82 F9 40 36|"; within:16; distance:80; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:20777; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption"; flow:to_client,established; file_data; content:"|0B 6F 21 00 00 78 9C ED 59 7D 6C 1B C7 95 9F 59|"; depth:16; offset:3; content:"|9A 85 C1 70 78 7E 7E BE 6B BE BB 4B D3 67 C2 91|"; within:16; distance:160; content:"|B1 1B 88 2D BA F6 4C 5B 75 82 9A 52 46 32 A5 2D|"; within:16; distance:144; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:20767; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Shockwave Flash Flex authoring tool XSS exploit attempt"; flow:to_server,established; content:"/EncDecUtils.swf|3F|"; fast_pattern; http_uri; content:"resourceModuleURLs="; nocase; http_uri; content:"http"; within:4; nocase; http_uri; metadata:service http; reference:cve,2011-2461; reference:url,www.adobe.com/support/security/bulletins/apsb11-25.html; classtype:attempted-admin; sid:20610; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash SWF ActionScript 3 ByteArray class vulnerability"; flow:to_client,established; file_data; content:"|4F 62 6A 65 63 74 0B 66 6C 61 73 68 2E 75 74 69 6C 73 01 41 08 75 73 2D 61 73 63 69 69 0E 77 72 69 74 65 4D 75 6C 74 69 42 79 74 65 06 6C 65 6E 67 74 68 08 70 6F 73 69 74 69 6F 6E 08 74 6F 53 74 72 69 6E 67|"; fast_pattern:only; content:"|72 65 70 72 6F 0D 66 6C 61 73 68 2E 64 69 73 70 6C 61 79 06 53 70 72 69 74 65 09 42 79 74 65 41 72 72 61 79 21 68 74 74 70 3A 2F 2F 61 64 6F 62 65|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2445; classtype:attempted-user; sid:20568; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash SWF AVM2 namespace lookup deref exploit"; flow:to_client,established; file_data; content:"|56 65 63 74 6F 72 04 53 68 75 6F 07 70 61 6E 74 65 73 74|"; fast_pattern; content:"|53 70 72 69 74 65 0B 5F 5F 41 53 33 5F 5F 2E 76 65 63|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2455; classtype:attempted-user; sid:20567; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player salign null javascript access attempt"; flow:to_client,established; file_data; content:"<script"; nocase; content:".salign"; distance:0; nocase; content:"document.body.style.zoom"; distance:0; content:"</script>"; distance:0; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2459; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20560; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionDefineFunction2 length overflow attempt"; flow:to_client,established; file_data; content:"|24 9D 50 B6 F2 62 C0 FA 0C 9C FF 00 2A 1C D4 4A 8C 1C 8E 77 EE B5 5C B7 B4 9E 46 67 FD EB A8 43|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2454; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20557; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player PlaceObjectX null pointer dereference attempt"; flow:to_client,established; file_data; content:"|00 26 00 78 03 00 00 FF D8 FF E0 00 10 4A 46 49 46 00 01 01 00 00 01 00 01 00 00 FF DB 00 43 00 2F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2450; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20556; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash MP4 ref_frame allocated buffer overflow attempt"; flow:to_client,established; file_data; content:"|FA 34 27 84 33 9E 09 F7 84 44 41 B9 D6 99 46 42 32 91 31 51 DC 4C 20 2E A9 4C A2 F5 46 C7 28 74|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2140; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-admin; sid:20555; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Stage 3D texture format overflow attempt"; flow:to_client,established; file_data; content:"ATF|05 B6 B2 BF 14 B1 37 00 00 01 00 00 00 66 72 61 6D 65 31 00 10 00 2E 00 1C C1 95|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2456; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20551; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Mover3D clipping exploit"; flow:to_client,established; file_data; content:"|05 72 6F 75 6E 64 09 72 6F 74 61 74 69 6F 6E 59 06 6D 6F 75 73 65 59 09 72 6F 74 61 74 69 6F 6E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2460; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20550; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript bytecode type confusion attempt"; flow:to_client,established; file_data; content:"|19 13 02 00 01 F0 4C 6F 61 64 69 6E 67 00 00 00 66 6C 61 73 68 2E 42 6F 6F 74 00 40 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2451; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20549; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player recursive doaction stack exhaustion"; flow:to_client,established; file_data; content:"|4E 96 02 00 08 04 8E 35 00 00 05 00 08 19 00 04|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2457; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20548; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player overlapping record overflow attempt"; flow:to_client,established; file_data; content:"|40 09 40 00 40 00 40 00 40 00 3F 15 59 00 00 00 0B 00 7A 72 37 AC FF FD 42 5A 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2453; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20547; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SWF embedded font null pointer attempt"; flow:to_client,established; file_data; content:"|00 01 00 04 00 09 00 10 8E 09 7F 40 2D 4E C0 4E 7C 15 3C 14 00 50|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2452; reference:url,www.adobe.com/support/security/bulletins/apsb11-28.html; classtype:attempted-user; sid:20545; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player recursive stack overflow attempt"; flow:to_client,established; file_data; content:"|42 1B EB 68 C4 A9 39 96 95 4B 0E 39 71 A9 9E E8 72 CE 38 A4 3B C4 92 4B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2426; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20211; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player pcre ActionScript under allocation"; flow:to_client,established; file_data; content:"|4D EA BB 49 2E 01 A2 21 8E F1 C7 FB 4B 42 0C 4E 66 D1 88 17 46 C8 B3 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2427; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20206; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player setInterval use attempt"; flow:to_client,established; file_data; content:"|27 93 BE 70 22 40 33 C1 A4 2F 69 0D A0 85 0B 34|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2011-2444; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20183; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player viewSource blacklist exclusion attempt"; flow:to_client,established; file_data; content:"<?xml"; content:"navigateToURL"; distance:0; nocase; pcre:"/navigateToURL[^\n]*\x28\s*[\x22\x27]\s*(view-source|mms|rlogin)[^\n]*\x29/i"; metadata:service http; reference:cve,2011-2429; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20182; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Speex-encoded audio buffer underflow attempt"; flow:to_client,established; file_data; content:"|A9 FC EB C4 44 EA 39 DC C2 E6 7A 38 85 81 71 46 3B 43 B6 E8 69 30 D5 77 47 47 A1 DE 99 B6 32 A2 7B D4 DA AD 90 AF 76 EB F4 B0 8D 3F F2 66 C5 06 3B 18 ED 9C 13 2E 42 BB 18 50 C2 ED D2 AE 33 B2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2130; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20181; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_client,established; file_data; content:"|01 00 00 00 08 1C 99 02 00 C4 FE 96 05 00 07 0C F5 4E 15 4C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:20131; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory consumption vulnerability"; flow:to_client,established; file_data; content:"CWS|09|"; depth:4; content:"|68 C4 21 5E 20 F0 E9 17 D8 EF DD 03 92 AC 4A 8C|"; within:16; distance:828; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-3793; classtype:denial-of-service; sid:20050; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption"; flow:to_client,established; file_data; content:"|64 62 01 2D 01 66 0B 41 01 29 47 00 00 02 03 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:20031; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash MP4 ref_frame allocated buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"NetStream"; nocase; content:"|16 03 16 05 16 07 18 09 16 0B 16 10 17 05 05 00 05 00 08 17 16 18 16 19 16 1A 16 1B 16 1C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2140; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-admin; sid:19693; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash cross-site request forgery attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|00|loadClip"; nocase; content:"|00|loadVariables"; nocase; content:"|00 8E 0F 00|loadUrl"; distance:0; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2011-2139; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19692; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Actionscript File reference buffer overflow attempt"; flow:to_client,established; file_data; content:"|F0 E8 E8 E8 45 42 64 43 21 B3 9F 04 1E DF 61 7F EC F9 02 5A BF 6B 6C 48 7E 4C 3C C4 96 03 BE 1F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2137; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19691; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Actionscript duplicateDoorInputArguments stack overwrite"; flow:to_client,established; file_data; content:"|00 C3 02 00 04 09 00 C4 02 00 01 06 00 C5 02 00 06 07 00 22 05 08 03 04 59 02 02 02 02 02 02 02|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2136; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19690; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Actionscript dynamic calculation double-free attempt"; flow:to_client,established; file_data; content:"|25 90 03 A2 5D 09 66 09 46 0A 00 25 90 03 A2 46 0B 02 29 65 01 5D 0C 4A 0C 00 82 6D 01 5D 0D 65|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2135; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-dos; sid:19689; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Actionscript BitmapData buffer overflow attempt"; flow:to_client,established; file_data; content:"|07 04 07 07 02 08 07 05 09 07 04 0A 07 04 0B 07 04 0C 07 06 0E 07 02 0F 07 02 10 07 02 11 07 02|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2138; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19688; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionStoreRegister instruction length invalidation attempt"; flow:to_client,established; file_data; content:"|00 04 03 08 61 4E 12 12 9D 02 00 4D 02 96 06 00 04 03 08 61 05 01 4F 96 02 00 08 12 1C 96 02 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2414; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-admin; sid:19687; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash uninitialized bitmap structure memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"display|3A|IBitmapDrawable"; nocase; content:"|02|sx|02|sy|02|tx|02|ty|01|a|01|b|01|c|01|d|0F|beginBitmapFill"; distance:0; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2425; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19686; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash regular expression grouping depth buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"RegExp"; nocase; content:"|28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28|"; within:50; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65703; reference:cve,2011-2134; reference:cve,2014-0499; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19685; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript 3 buffer overflow attempt"; flow:to_client,established; file_data; content:"|E9 3F 00 00 00 00 00 00 D0 3F 33 33 33 33 33 33 E3 3F 7B 14 AE 47 E1 7A A4 3F 66 66 66 66 66 66 F6 3F 9A 99 99 99 99 99 B9 3F EB 09 00 07 42 6F 6F 6C 65 61 6E 04 76 6F 69 64 03 69 6E 74 0B 66|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2415; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19683; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript 3 integer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|02 61 30 02 61 31 02 61 32 02 61 33 02 61 34 02 61 35 02 61|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49081; reference:cve,2011-2416; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19682; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption exploit attempt"; flow:to_client,established; file_data; content:"CWS|09|"; content:"|3D BF CF FB CF 8B D6 E9 EE EA EA EA AA EA EA EA|"; within:16; distance:94; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-0197; reference:cve,2010-1297; classtype:attempted-admin; sid:19408; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"chunked"; content:"C"; within:50; content:"W"; within:10; content:"S"; within:10; content:"|0A|"; within:10; content:"|DC|"; within:10; content:"|CC|"; within:10; content:"|00|"; within:10; content:"|00|"; within:10; content:"|DA|"; within:10; content:"|7C|"; within:10; content:"|BD|"; within:10; content:"|4B|"; within:10; content:"|D3|"; within:10; content:"|6E|"; within:10; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-01.html; classtype:attempted-user; sid:19293; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption"; flow:to_client,established; file_data; content:"|8E 1D FE E9 F1 B8 EE D3 C3 FB F2 8E 75 9D DD AB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:19264; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption"; flow:to_client,established; file_data; content:"|67 D9 C1 1F 1F 8D EB 3E 3D B8 27 F7 48 E7 E9 DD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:19263; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption"; flow:to_client,established; file_data; content:"|79 76 E8 C7 47 E3 BA CF 0E EE C9 3B D2 75 7A B7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:19262; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index memory corruption"; flow:to_client,established; file_data; content:"|5F 30 64 61 79 32 5F 66 6C 61 0C 4D 61 69 6E 54 69 6D 65 6C 69 6E 65|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:19257; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Universal3D meshes.removeItem exploit attempt"; flow:to_client,established; file_data; content:"|2F|Type|20 2F|3D|20 2F|Subtype|20 2F|U3D"; nocase; content:"c3d.scene.nodes.removeItem|28 76 31 29 3B|"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2099; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-admin; sid:19249; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player cross-site request forgery attempt"; flow:to_client,established; file_data; content:"|09 1C 96 02 00 08 0B 52 17 96 05 00 07 E8 03 00 00 8E 08 00 00 00 00 03 2A 00 D3 00 96 09 00 08|"; fast_pattern:only; metadata:service http; reference:cve,2011-2107; reference:url,www.adobe.com/support/security/bulletins/apsb11-13.html; classtype:attempted-user; sid:19179; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player cross-site request forgery attempt"; flow:to_client,established; file_data; content:"|52 CA 95 3B 3C C3 B0 C5 AA 52 C4 E1 8D 98 0E 9E F8 27 0B F8 26 0D 78 B1 3D B7 C5 16 F8 3A 85 08|"; fast_pattern:only; metadata:service http; reference:cve,2011-2107; reference:url,www.adobe.com/support/security/bulletins/apsb11-13.html; classtype:attempted-user; sid:19178; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_client,established; file_data; content:"|D2 60 3B 40 C1 03 AB 12 E5 00 00 60 E8 03 24 00|"; content:"|46 FF 04 02 75 63 07 60 97 01 24 02 A1 62 04 0E|"; within:16; distance:16; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:19145; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 1935 (msg:"FILE-FLASH Adobe Flash Media Server memory exhaustion"; flow:to_server,established; content:"|0D|eval.toString|00|"; content:"-9999999999"; distance:12; reference:cve,2009-3791; classtype:misc-activity; sid:19111; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; file_data; content:"|33 0D 0A 43 57 53 0D 0A 31 0D 0A 0A 0D 0A 33 0D|"; content:"|0D 0A 34 0D 0A FE B3 6F 7D 0D 0A 33 0D 0A FC F1|"; within:16; distance:320; content:"|32 0D 0A F5 CB 0D 0A 33 0D 0A 4B 7C F1 0D 0A 34|"; within:16; distance:320; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:19083; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; file_data; content:"|64 BF B2 5C 3B 6C 01 CC 94 D8 86 75 E0 13 57 80|"; content:"|00 1C 84 81 C9 80 77 6F 72 6B 50 6F 73 5F 6D 63|"; within:16; distance:320; content:"|FD 8D AD 6D 92 AB 5A B5 AF EC 90 2F 1A 4C 2A 01|"; within:16; distance:320; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:19080; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|D7 F3 DB DF 19 6F DB FC E6 F7 5F CF 2F BF 99 BE|"; content:"|78 F9 BB 3F 7D FD 27 7C F9 FE AB F9 7A 7C E5 D3|"; within:16; distance:336; content:"|27 5F FD FC 7D 7D F7 FE 1F FC 7A 6B BF 7C 3F DF|"; within:16; distance:288; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:19071; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH RealNetworks RealPlayer FLV parsing two integer overflow vulnerabilities"; flow:to_client, established; flowbits:isset,file.swf; file_data; content:"FLV"; depth:3; content:"onMetaData|08|"; byte_test:4,>,0x7507507,0,relative; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,42775; reference:cve,2010-3000; classtype:attempted-user; sid:19002; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash player content parsing execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"ROPPayload|08|strToInt|09|shellcode"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,44503; reference:cve,2010-3654; classtype:attempted-user; sid:18992; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash beginGradientfill improper color validation attempt"; flow:to_client,established; file_data; content:"|2B 6D 01 65 01 5D BD 02 5D BB 02 65 01 6C 04 46 BB 02 01 46 BD 02 01 60 09 87 80 09 6D 04 10 2D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0620; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18971; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player null pointer dereference attempt"; flow:to_client,established; file_data; content:"|F4 00 3F 00 7F 12 0D 00 00 00 1D 00 80 02 08 3B 00 00 00 00 DE 42 03 FF 02 19 00 00 00 1E 00 50|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0626; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18970; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript ActionIf integer overflow attempt"; flow:to_client,established; file_data; content:"|00 18 36 00 3F 03 07 00 00 00 12 9D 02 00 12 B1 00 40 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0623; reference:cve,2011-0625; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18969; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript3 stack integer overflow attempt"; flow:to_client,established; file_data; content:"|2A 2A 24 48 24 65 24 6C 2A 24 6F 24 00 24 40 24 00 2A 2A 56|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0618; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18968; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe ActionScript argumentCount download attempt"; flow:to_client,established; file_data; content:"|0B 0B D0 30 20 80 04 24 01 55 01 02 47 00 00 02|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0621; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18967; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash file DefineFont4 remote code execution attempt"; flow:to_client,established; file_data; content:"|01 01 09 00 04 00 02 00 00 00 02 00 00 01 0D 07 00 02 01 07 09 00 00 02 02 08 07|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0627; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18966; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash file ActionScript 2 ActionJump remote code execution attempt"; flow:to_client,established; file_data; content:"|99 02 00 BC CB|"; content:"|99 02 00 39 FA|"; distance:0; content:"|99 02 00 48 9D 99 02 06 A2 F9|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0624; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18965; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash file DefineFont4 remote code execution attempt"; flow:to_client,established; file_data; content:"|FF 16 D8 89 00 00 01 00 04 57 69 6E 64 73 6F 6E 67 00 4F 54 54 4F 00 0A 00 80 00 03 00 20 43 46 46 20 C5 97 55|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0619; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18964; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe ActionScript 3 addEventListener exploit attempt"; flow:to_client,established; file_data; content:"|AB 02 60 90 01 4F AC 02 02 47 00 00 67 03 02 09|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0622; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; classtype:attempted-user; sid:18963; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player undefined tag exploit attempt"; flow:to_client,established; file_data; content:"|46 57 53 0A 9A 04 00 00 78 00 03 E8 00 00 0F A0 00 00 E8 01 00 44 11 08 00 00 00 3F 12 69 04 00|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2214; classtype:attempted-user; sid:18805; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH embedded Shockwave dropper in email attachment"; flow:to_server,established; file_data; content:"FWS|09 47 CB 00 00 48 01 40 00 5A 00 00 19 01 00 44 11 08 00 00 00 BF 14 1C CB 00 00 00 00 00 00 00 10 00 2E 00 06 00 80 80 40 94 A8 D0 A0 01 80 80 04 10 00 02 00 00 00 12 12 12 E2 41 30 F0 09|1414141414141414"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-05.html; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:18544; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH embedded Shockwave dropper download"; flow:to_client,established; file_data; content:"FWS|09 47 CB 00 00 48 01 40 00 5A 00 00 19 01 00 44 11 08 00 00 00 BF 14 1C CB 00 00 00 00 00 00 00 10 00 2E 00 06 00 80 80 40 94 A8 D0 A0 01 80 80 04 10 00 02 00 00 00 12 12 12 E2 41 30 F0 09|1414141414141414"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-05.html; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:18543; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript flash.geom.Point constructor memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|0A|flash.geom|06|Matrix|0B|setMaterial"; content:"|05|Point"; distance:0; content:"|12|generateFilterRect|0B|applyFilter"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0578; reference:url,www.adobe.com/support/security/bulletins/apsb11-02.html; classtype:attempted-user; sid:18503; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe OpenAction crafted URI action thru Firefox attempt"; flow:to_client,established; file_data; content:"|2F|OpenAction|20 3C 3C|"; fast_pattern:only; pcre:"/[^\x3e]{0,300}\x2fURI \x28data/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2011-0587; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18447; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-FLASH Adobe Acrobat Flash Player nvapi.dll dll-load exploit attempt"; flow:to_server,established; content:"n|00|v|00|a|00|p|00|i|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0575; reference:url,www.adobe.com/support/security/bulletins/apsb11-02.html; classtype:attempted-user; sid:18446; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Acrobat Flash Player nvapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|nvapi.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0575; reference:url,www.adobe.com/support/security/bulletins/apsb11-02.html; classtype:attempted-user; sid:18445; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash player ActionScript ASnative function remote code execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"ASnative|00|"; content:"|96 16 00 07 03 00 00 00 07 2E 01 00 00 07 3A 08 00 00 07 02 00 00 00 08 02|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0559; reference:url,www.adobe.com/support/security/bulletins/apsb11-02.html; classtype:attempted-user; sid:18420; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash player ActionScript apply function memory corruption attempt"; flow:to_client,established; file_data; content:"|43 57 53 0A 2C 91 00 00 78 9C CD BD 77 60 54 D5 D6 3E 7C F6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0558; reference:url,www.adobe.com/support/security/bulletins/apsb11-02.html; classtype:attempted-user; sid:18418; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash authplay.dll memory corruption attempt"; flow:to_client,established; file_data; content:"|94 C5 F6 3F 3E E5 D9 7D 76 53 37 D9 10 62 28 06 8D 44 71|"; content:"|CC F3 6C A1 DC 0F DF DF EB F5 FD E7 8B 99 E7 99 39 73 E6 CC 99|"; distance:0; content:"|EE 7E F1 F1 1E E9 C8 72 36 A9 3A 54 1F 2A 1A C4 58 B7 DB|"; distance:0; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-3654; reference:url,www.adobe.com/support/security/advisories/apsa10-05.html; classtype:attempted-user; sid:17808; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash frame type identifier memory corruption attempt"; flow:to_client,established; file_data; content:"|0B 25 C9 92 0D 21 ED 48 87 65 30 3B 6D E1 D8 B4 00 00 86 06 06 01 00 01 00 00 40 00 00 00|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,15332; reference:cve,2005-2628; classtype:attempted-user; sid:17658; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_client,established; file_data; content:"|A3 D9 86 B1 D3 6F 07 ED BF 7D EB C4 59 9B 2E C0 84 E8 1F 00 00 00 FF FF 03 00 89 17 52 74|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:17606; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionDefineFunction memory access exploit attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"FWS|06|"; depth:4; content:"|43 02|"; within:27; byte_test:1,<,64,3,relative; content:"|03|"; within:1; distance:4; pcre:"/^(\x9B|\x8E)/R"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,15334; reference:cve,2005-2628; classtype:attempted-user; sid:17457; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH RealNetworks RealPlayer SWF flash file buffer overflow attempt"; flow:to_client,established; file_data; content:"|46 57 53 05 CF 00 00 00 60 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,17202; reference:cve,2006-0323; classtype:attempted-user; sid:17334; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player and Reader remote code execution attempt"; flow:to_client,established; file_data; content:"|6C 23 B1 63 9A 87 31 36 CC 6F DD BA 75 7F C7 D0|"; depth:160; offset:144; content:"|9F 4E AA 98 1C 24 BF 33 AE 78 A5 58 32 B3 DE 54|"; within:16; distance:352; content:"|05 7D 9F EA A8 E5 CA A6 73 4A CE BC 5C 72 65 63|"; within:16; distance:240; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2884; reference:url,www.adobe.com/support/security/advisories/apsa10-03.html; classtype:attempted-user; sid:17257; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player navigateToURL cross-site scripting attempt"; flow:to_client,established; file_data; content:"|11 BA EE 66 DA B8 6C D6 A9 D7 D9 C2 DB F0 26 7D|"; fast_pattern:only; metadata:service http; reference:bugtraq,26960; reference:cve,2007-6244; classtype:misc-activity; sid:17223; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SWF ActionScript exploit attempt"; flow:to_client,established; file_data; content:"|04 01 08 32 4E 96 04 00 04 01 08 2D 4E 4E 96 09 00 03 49 12 9D 02 00 09 00 96 04 00 04 01 08 08 4E 3E 96 04 00|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-0209; reference:url,www.adobe.com/support/security/bulletins/apsb10-16.html; classtype:attempted-user; sid:17142; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash invalid data precision arbitrary code execution exploit attempt"; flow:to_client,established; file_data; content:"|0C 0C FF C0 00 11 88 00 96 00 71 03 01 11 00 02|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2216; reference:url,www.adobe.com/support/security/bulletins/apsb10-16.html; classtype:attempted-user; sid:17141; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash use-after-free attack attempt"; flow:to_client,established; file_data; content:"|53 68 68 68 20 64 6F 6E 27 74 20 74 65 6C 6C 20 61 6E 79 20 6F 6E 65 20 74 68 69 73 20 69 73 20 61 20 73 65 63 72 65 74 20 6B 65 79 21 16 54 68 65 20 74 72 75 74 68 20 69 73 20 6F 75 74 20 74 68 65 72 65 08 43 4F 4D 50 4C 45 54 45 0B 72 65 6D 6F 76 65 43 68 69 6C 64 0A 55 52 4C 52 65 71 75 65 73 74 30 68 74 74 70|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1297; classtype:attempted-user; sid:16634; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player JPEG parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|FF D8 FF E0|"; content:"JFIF|00|"; within:5; distance:2; content:"|FF C0|"; within:2; distance:9; byte_test:2,>,0x7fff,3,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3794; classtype:attempted-user; sid:16331; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malformed getPropertyLate actioncode attempt"; flow:to_client,established; file_data; content:",|BD 06|J|C6 01 01 80 C6 01 D6 D1 D2|O|97 06 01 D1|`|81 04|g|9D 08|f|9E 08|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3797; classtype:attempted-user; sid:16316; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash PlugIn check if file exists attempt"; flow:to_client, established; file_data; content:".Movie"; content:".readyState"; distance:0; pcre:"/document\x2E(.*?)\x2EMovie\s*\x3D.*document\x2E\1\x2EreadyState\s*\x21?\x3D+\s*4/smi"; metadata:service http; reference:cve,2009-3951; classtype:misc-activity; sid:16315; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript intrf_count integer overflow attempt"; flow:to_client,established; file_data; content:"|01 01 02 09 03 80 80 80 80 01 01 02 01 01 04 01 00 03 00 01 01 09|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,35907; reference:cve,2009-1869; classtype:attempted-user; sid:15993; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_client,established; file_data; content:"|00|airappinstaller|00|ASnative|00|"; pcre:"/\x00[\x3b\x7c\x26\x60][^\x00]+\x00airappinstaller\x00ASnative\x00/smi"; content:"|99 08|"; distance:0; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:15869; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Possible Adobe Flash ActionScript byte_array heap spray attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"ByteArray"; nocase; content:"|04 0C 0C 0C 0C|"; within:100; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,35759; reference:cve,2009-1862; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:attempted-user; sid:15729; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player invalid object reference code execution attempt"; flow:to_client,established; file_data; content:"|43 57 53 06 40 F3 14 00 78 DA 44 7C 05 58 54 DB F7 F6 1A 66 80 A1 87 54 86 EE EE A1 86 9A A1 41 10 10 A4 2C 44 3A 2C 10 0B 61 08 15 41 10 15 95 52 4A 01 11 15 05 F4 9A A0 A2 5E 95 10 30 08 03|"; depth:64; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,33880; reference:cve,2009-0520; classtype:attempted-user; sid:15478; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|A8 15|"; content:"|8C 15|"; within:2; distance:40; content:"|BF 14 7F 01 00 00|"; within:6; distance:12; content:"|19 13|"; within:2; distance:383; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13822; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|BF 15 84 03 00 00|"; content:"|BF 14|D|02 00 00|"; within:6; distance:900; content:"?|13 1F 00 00 00|"; within:6; distance:640; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13821; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|A8 15|"; content:"|BF 15 0C 00 00 00|"; within:6; distance:45; content:"|BF 14 7F 01 00 00|"; within:6; distance:12; content:"?|13 19 00 00 00|"; within:6; distance:383; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13820; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player embedded JPG image height overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"FWS"; content:"|FF D8|"; distance:0; content:"JFIF"; distance:0; content:"|FF C0|"; within:256; pcre:"/^...(..)?[\x80-\xff]/R"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-admin; sid:13300; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe FLV long string script data buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.flv; file_data; content:"|12|"; content:"|00|"; within:8; content:"|02|"; within:1; distance:9; byte_jump:2,0,relative,big; content:"|0C|"; within:1; byte_test:4, >, 2147483647, 0, relative, big; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,24856; reference:cve,2007-3456; classtype:attempted-admin; sid:12183; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash DOACTION tag overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"FWS"; content:"|03|"; distance:19; content:!"|00|"; within:1; byte_test:1,<,128,0,relative; content:"|9B|"; within:1; distance:1; content:!"|00|"; within:1; distance:-2; metadata:service ftp-data, service http, service imap, service pop3; reference:url,www.macromedia.com/devnet/security/security_zone/mpsb05-07.html; classtype:attempted-user; sid:4675; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player remote memory corruption attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|E8 3F 00 00 00 00 00 00 00 00 E9 04 00 04|void|19|promolenta.dat"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,60478; reference:cve,2013-3343; reference:url,www.adobe.com/support/security/bulletins/apsb13-16.html; classtype:attempted-user; sid:26983; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player remote memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|E8 3F 00 00 00 00 00 00 00 00 E9 04 00 04|void|19|promolenta.dat"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,60478; reference:cve,2013-3343; reference:url,www.adobe.com/support/security/bulletins/apsb13-16.html; classtype:attempted-user; sid:26982; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malicious swf file download attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|CB 74 5E 0D BD 47 57 13 3F E7 55 4F 02 D4 3F D9 8E D3 C4 6E D4 07 3E 41 FD FB E1 4F 63 29|"; fast_pattern:only; metadata:service smtp; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:27187; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malicious swf file download attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|E5 8C 2E 73 DC 35 EE 09 13 9E 09 87 C3 E9 76 8E C8 1B B9 F2 84 4A 53 90 EB F5 D5 5A 60 BC|"; fast_pattern:only; metadata:service smtp; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:27186; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malicious swf file download attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|AE D7 46 41 60 D2 E4 25 52 2F 88 38 EA B9 BC D1 1B F2 95 52 B8 2C 8E C7 B4 21 A9 2F 62 26|"; fast_pattern:only; metadata:service smtp; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:27185; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malicious swf file download attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|CB 74 5E 0D BD 47 57 13 3F E7 55 4F 02 D4 3F D9 8E D3 C4 6E D4 07 3E 41 FD FB E1 4F 63 29|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:27184; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malicious swf file download attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|E5 8C 2E 73 DC 35 EE 09 13 9E 09 87 C3 E9 76 8E C8 1B B9 F2 84 4A 53 90 EB F5 D5 5A 60 BC|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:27183; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malicious swf file download attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|AE D7 46 41 60 D2 E4 25 52 2F 88 38 EA B9 BC D1 1B F2 95 52 B8 2C 8E C7 B4 21 A9 2F 62 26|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:27182; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash ActionScript user-supplied PCM resampling integer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|88 ED 54 2A 27 AA 96 79 2A EA 47 81 9B 4A 5A A6 46 5C 32 22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,61048; reference:cve,2013-3347; reference:url,www.adobe.com/support/security/bulletins/apsb13-17.html; classtype:attempted-user; sid:27268; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript user-supplied PCM resampling integer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|88 ED 54 2A 27 AA 96 79 2A EA 47 81 9B 4A 5A A6 46 5C 32 22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,61048; reference:cve,2013-3347; reference:url,www.adobe.com/support/security/bulletins/apsb13-17.html; classtype:attempted-user; sid:27267; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player heap buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|76 DB E9 F0 AD 26 55 2A C8 BD 68 4C 99 A4 8A D8 6B 7F 9D 15 22 41 05 7B 76 A3 20 2A 54 5C DB A8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,61045; reference:cve,2013-3345; reference:url,www.adobe.com/support/security/bulletins/apsb13-17.html; classtype:attempted-user; sid:27266; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player heap buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|76 DB E9 F0 AD 26 55 2A C8 BD 68 4C 99 A4 8A D8 6B 7F 9D 15 22 41 05 7B 76 A3 20 2A 54 5C DB A8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,61045; reference:cve,2013-3345; reference:url,www.adobe.com/support/security/bulletins/apsb13-17.html; classtype:attempted-user; sid:27265; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player embedded JPG image height overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"FWS"; content:"|FF D8|"; distance:0; content:"JFIF"; distance:0; content:"|FF C0|"; within:256; pcre:"/^...(..)?[\x80-\xff]/R"; metadata:service smtp; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-admin; sid:27671; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Action InitArray stack overflow attempt"; flow:to_server, established; flowbits:isset, file.swf; file_data; content:"|96 05 00 07|"; byte_test:4,>,0x040000,0,relative,little; content:"|42|"; within:1; distance:4; metadata:policy security-ips drop, service smtp; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:27755; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Action InitArray stack overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|96|"; byte_jump:2,0,relative,little; content:"|42|"; within:1; content:"|07|"; within:1; distance:-6; byte_test:4,>,0x040000,0,relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5269; reference:url,www.adobe.com/support/security/bulletins/apsb12-24.html; classtype:attempted-user; sid:27754; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.ppt; file_data; content:"|4F 78 41 41 41 44 73 51 42 6C 53 73 4F 47 77 41 41 42 73 42 4A 52 45 46 55 65 46 37 74 30 30 45|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:28453; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.doc; file_data; content:"|50 33 49 41 56 51 67 42 56 67 67 42 42 68 5A 6F 42 44 39 79 41 41 41 50 41 32 6F 41 41 41 41 41|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:28452; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.doc; file_data; content:"|1D 00 10 00 25 00 00 00 82 A0 1E 02 FF FF FF FF FE FF FF FF 40 01 00 00 02 00 FF FF FE FF FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:28451; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|EF 06 02 01 01 04 1E D0 30 F1 F6 12 F0 1A 5D 86 0B 60 18 30 60 05 30 60|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3363; reference:url,www.adobe.com/support/security/bulletins/apsb13-21.html; classtype:attempted-user; sid:28590; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|EF 06 02 01 01 04 1E D0 30 F1 F6 12 F0 1A 5D 86 0B 60 18 30 60 05 30 60|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3363; reference:url,www.adobe.com/support/security/bulletins/apsb13-21.html; classtype:attempted-user; sid:28589; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player GlyphOffset memory disclosure attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|FF 12|"; content:"|00 00 E0 6D 00 40 33 6F 00 00 0F 70 00 00 87 70|"; within:600; distance:10; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5324; reference:url,www.adobe.com/support/security/bulletins/apsb13-21.html; classtype:attempted-user; sid:28588; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player GlyphOffset memory disclosure attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|FF 12|"; content:"|00 00 E0 6D 00 40 33 6F 00 00 0F 70 00 00 87 70|"; within:600; distance:10; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5324; reference:url,www.adobe.com/support/security/bulletins/apsb13-21.html; classtype:attempted-user; sid:28587; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player remote memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|4E 8F 5F B5 DD 60 BE 81 C5 22 83 F9 36 83 B9 8E 1E 3F 93 86 D2 2D 28 73 B2 AF 7E BB D3 B9 E3 BD D8 6D 7B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,62294; reference:cve,2013-3362; reference:url,adobe.com/support/security/bulletins/apsb13-21.html; classtype:attempted-user; sid:28569; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player remote memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|4E 8F 5F B5 DD 60 BE 81 C5 22 83 F9 36 83 B9 8E 1E 3F 93 86 D2 2D 28 73 B2 AF 7E BB D3 B9 E3 BD D8 6D 7B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,62294; reference:cve,2013-3362; reference:url,adobe.com/support/security/bulletins/apsb13-21.html; classtype:attempted-user; sid:28568; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player use after free race condition"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|6F AB DE 4D E9 B5 73 2F 00 25 84 02 B2 A9 B5 4A 7F 11 B0 40 00 10 0D 0B 20 1E 18 CF 62 C7 66 EB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3361; reference:url,www.adobe.com/support/security/bulletins/apsb13-21.html; classtype:attempted-user; sid:28567; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_server,established; file_data; content:"|85 83 F2 B6 D6 39 71 DC B0 00 D5 DA 5C 93 73 BF A0 EB ED 76 3B DB 5E CA 7A 41 43 CF AD AC AC E8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:28620; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_client,established; file_data; content:"|85 83 F2 B6 D6 39 71 DC B0 00 D5 DA 5C 93 73 BF A0 EB ED 76 3B DB 5E CA 7A 41 43 CF AD AC AC E8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:28619; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Matrix3D copyRawDataTo integer overflow attempt"; flow:to_server,established; file_data; content:"__AS3__.vec|06|Number|0D|copyRawDataTo|07|poc/poc|0D|flash"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55691; reference:cve,2012-5054; reference:url,osvdb.org/show/osvdb/85786; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:attempted-user; sid:28745; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Matrix3D copyRawDataTo integer overflow attempt"; flow:to_client,established; file_data; content:"__AS3__.vec|06|Number|0D|copyRawDataTo|07|poc/poc|0D|flash"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55691; reference:cve,2012-5054; reference:url,osvdb.org/show/osvdb/85786; reference:url,www.adobe.com/support/security/bulletins/apsb12-19.html; classtype:attempted-user; sid:28744; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash OpenType font memory corruption attempt"; flow:to_server,established; file_data; content:"|8A 31 5B D0 1A 53 E3 71 60 46 4F 0E B7 5F 45 7C C5 31 35 B0 25 D6 5E D8 FC BF D2 04 78 07|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55009; reference:cve,2012-1535; reference:url,www.adobe.com/support/security/bulletins/apsb12-18.html; classtype:attempted-user; sid:28708; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash OpenType font memory corruption attempt"; flow:to_client,established; file_data; content:"|8A 31 5B D0 1A 53 E3 71 60 46 4F 0E B7 5F 45 7C C5 31 35 B0 25 D6 5E D8 FC BF D2 04 78 07|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55009; reference:cve,2012-1535; reference:url,www.adobe.com/support/security/bulletins/apsb12-18.html; classtype:attempted-user; sid:28707; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash OpenType font memory corruption attempt"; flow:to_server,established; file_data; content:"|63 51 A3 14 70 D7 42 BB 72 07 92 11 3A E5 7B C1 2F DA 86 FB B0 33 1B F3 FF 02 FB 91 38 93|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55009; reference:cve,2012-1535; reference:url,www.adobe.com/support/security/bulletins/apsb12-18.html; classtype:attempted-user; sid:28706; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash OpenType font memory corruption attempt"; flow:to_client,established; file_data; content:"|63 51 A3 14 70 D7 42 BB 72 07 92 11 3A E5 7B C1 2F DA 86 FB B0 33 1B F3 FF 02 FB 91 38 93|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,55009; reference:cve,2012-1535; reference:url,www.adobe.com/support/security/bulletins/apsb12-18.html; classtype:attempted-user; sid:28705; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption attempt"; flow:to_server,established; file_data; content:"|6B 27 78 42 86 2E 09 60 48 C0 2A B6 45 88 DC 57 DE CD 5F 96 1F 1E CE ED F0 0B 24 B4 69 6D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:28704; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript float index array memory corruption attempt"; flow:to_client,established; file_data; content:"|6B 27 78 42 86 2E 09 60 48 C0 2A B6 45 88 DC 57 DE CD 5F 96 1F 1E CE ED F0 0B 24 B4 69 6D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:28703; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_server,established; file_data; content:"|FC 96 56 84 F6 07 6F 04 D2 E8 B4 3F 78 27 90 F8 AB 5E CD 12 E2 2B DF 68 FF 05 E4 69 98 C9|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:28702; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_server,established; file_data; content:"|C9 6F 69 45 68 7F F0 46 20 8D 4E FB 83 77 02 89 BF EA D5 22 21 BE F2 8D F6 5F B7 70 AA F7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:28701; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_client,established; file_data; content:"|FC 96 56 84 F6 07 6F 04 D2 E8 B4 3F 78 27 90 F8 AB 5E CD 12 E2 2B DF 68 FF 05 E4 69 98 C9|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:28700; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_client,established; file_data; content:"|C9 6F 69 45 68 7F F0 46 20 8D 4E FB 83 77 02 89 BF EA D5 22 21 BE F2 8D F6 5F B7 70 AA F7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:28699; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_server,established; file_data; content:"|9A 00 EF 36 69 D1 BC B4 ED AB 5D F6 03 F1 AC 7A B4 44 DE FA 75 50 71 E4 FF 00 75 AE 44 E2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:28698; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_server,established; file_data; content:"|68 08 AC 3B A5 39 FD E2 C6 6F B6 1A 0F 07 13 D1 A3 59 42 4B 37 20 8A 2B FF 17 3C 81 5D 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:28697; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_client,established; file_data; content:"|9A 00 EF 36 69 D1 BC B4 ED AB 5D F6 03 F1 AC 7A B4 44 DE FA 75 50 71 E4 FF 00 75 AE 44 E2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:28696; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript callMethod type confusion attempt"; flow:to_client,established; file_data; content:"|68 08 AC 3B A5 39 FD E2 C6 6F B6 1A 0F 07 13 D1 A3 59 42 4B 37 20 8A 2B FF 17 3C 81 5D 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47314; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:28695; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; file_data; content:"|B3 9F FB 7A F6 92 EF FC CB 25 DF BE F8 D2 4B BE 73 71 E0 4B 81 F2 BF FF 05 AE EB 05 87 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,46860; reference:cve,2011-0609; classtype:attempted-user; sid:28694; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; file_data; content:"|B3 9F FB 7A F6 92 EF FC CB 25 DF BE F8 D2 4B BE 73 71 E0 4B 81 F2 BF FF 05 AE EB 05 87 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46860; reference:cve,2011-0609; classtype:attempted-user; sid:28693; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; file_data; content:"|F9 CB B2 5F F8 7A F6 D2 EF FC CB A5 DF BE E4 B2 4B BF 73 49 E0 1F 29 F5 7F 01 0A E7 FC 22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,46860; reference:cve,2011-0609; classtype:attempted-user; sid:28692; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; file_data; content:"|F9 CB B2 5F F8 7A F6 D2 EF FC CB A5 DF BE E4 B2 4B BF 73 49 E0 1F 29 F5 7F 01 0A E7 FC 22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46860; reference:cve,2011-0609; classtype:attempted-user; sid:28691; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_server,established; file_data; content:"|A5 9C EC D7 B0 81 F3 EC FD 23 0B A9 30 49 CA 91 93 87 E3 AF C2 E9 70 1D EC 0F AD ED 42 7D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:28690; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_server,established; file_data; content:"|71 8D F1 61 C0 22 78 6D EC E6 CD 6A 1F 7E D4 3B A7 D5 0F F8 7E 70 B8 31 D9 27 5C 16 71 B7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:28689; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_client,established; file_data; content:"|A5 9C EC D7 B0 81 F3 EC FD 23 0B A9 30 49 CA 91 93 87 E3 AF C2 E9 70 1D EC 0F AD ED 42 7D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:28688; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ActionScript virtual machine opcode verifying code execution attempt"; flow:to_client,established; file_data; content:"|71 8D F1 61 C0 22 78 6D EC E6 CD 6A 1F 7E D4 3B A7 D5 0F F8 7E 70 B8 31 D9 27 5C 16 71 B7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5271; reference:url,adobe.com/support/security/bulletins/apsb12-22.html; classtype:attempted-user; sid:28687; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_server,established; file_data; content:"|A8 AE 9F FC DD 34 E7 24 FF 71 36 DB 9A 32 40 27 DD 18 C9 F7 D3 CB E2 5C C3 6F 8F 41 75 7F|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28686; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_client,established; file_data; content:"|A8 AE 9F FC DD 34 E7 24 FF 71 36 DB 9A 32 40 27 DD 18 C9 F7 D3 CB E2 5C C3 6F 8F 41 75 7F|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28685; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_server,established; file_data; content:"|EA F9 C9 DF 4D 73 4E F2 1F 67 B3 AD 09 03 F4 BB 1B 23 F9 7E 7A 59 9C 6A F8 05 5E 81 75 F8|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28684; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_client,established; file_data; content:"|EA F9 C9 DF 4D 73 4E F2 1F 67 B3 AD 09 03 F4 BB 1B 23 F9 7E 7A 59 9C 6A F8 05 5E 81 75 F8|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28683; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_server,established; file_data; content:"|A4 EB C5 BF 9F 90 EF 24 9F 38 AB 6D 6E 36 40 D7 D9 18 C9 FB 53 CD A2 A9 E0 17 3E D2 69 48|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28682; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_client,established; file_data; content:"|A4 EB C5 BF 9F 90 EF 24 9F 38 AB 6D 6E 36 40 D7 D9 18 C9 FB 53 CD A2 A9 E0 17 3E D2 69 48|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28681; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_server,established; file_data; content:"|62 99 B5 A1 ED 70 C6 6B 74 3D 08 66 D0 21 30 D8 40 F5 1F 00 00 00 FF FF 03 00 91 59 C1 F2|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28680; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_client,established; file_data; content:"|62 99 B5 A1 ED 70 C6 6B 74 3D 08 66 D0 21 30 D8 40 F5 1F 00 00 00 FF FF 03 00 91 59 C1 F2|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28679; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_server,established; file_data; content:"|A3 D9 86 B1 D3 6F 07 ED BF 7D EB C4 59 9B 2E C0 84 E8 1F 00 00 00 FF FF 03 00 89 17 52 74|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28678; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player ASnative command execution attempt"; flow:to_server,established; file_data; content:"|00|airappinstaller|00|ASnative|00|"; pcre:"/\x00[\x3b\x7c\x26\x60][^\x00]+\x00airappinstaller\x00ASnative\x00/smi"; content:"|99 08|"; distance:0; metadata:service smtp; reference:bugtraq,32896; reference:cve,2008-5499; reference:url,www.adobe.com/support/security/bulletins/apsb08-24.html; classtype:attempted-user; sid:28677; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_server,established; file_data; content:"|0B 47 2E 1C D9 E2 DA 33 AB CF 15 76 BD ED 31 D3 90 39 FD BE 7B 50 4A 94 BE 58 F0 05 EB 73|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:28676; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_client,established; file_data; content:"|0B 47 2E 1C D9 E2 DA 33 AB CF 15 76 BD ED 31 D3 90 39 FD BE 7B 50 4A 94 BE 58 F0 05 EB 73|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:28675; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_server,established; file_data; content:"|BC 56 54 D3 2D 96 1D 9E DA 39 5A 20 62 52 14 8F 23 6E 91 04 37 1A C1 2D 12 8C AC A7 1D 24|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:28674; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player newfunction memory corruption attempt"; flow:to_client,established; file_data; content:"|BC 56 54 D3 2D 96 1D 9E DA 39 5A 20 62 52 14 8F 23 6E 91 04 37 1A C1 2D 12 8C AC A7 1D 24|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:28673; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash frame type identifier memory corruption attempt"; flow:to_server,established; file_data; content:"|0B 25 C9 92 0D 21 ED 48 87 65 30 3B 6D E1 D8 B4 00 00 86 06 06 01 00 01 00 00 40 00 00 00|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,15332; reference:cve,2005-2628; classtype:attempted-user; sid:28672; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash frame type identifier memory corruption attempt"; flow:to_server,established; file_data; content:"|BC 8A 6F 3D DA 53 0D AC 73 1F DE D8 C2 C0 D0 C6 C6 C6 08 54 C7 E0 00 94 05 00 53 50 10 B8|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,15332; reference:cve,2005-2628; classtype:attempted-user; sid:28671; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash frame type identifier memory corruption attempt"; flow:to_client,established; file_data; content:"|BC 8A 6F 3D DA 53 0D AC 73 1F DE D8 C2 C0 D0 C6 C6 C6 08 54 C7 E0 00 94 05 00 53 50 10 B8|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,15332; reference:cve,2005-2628; classtype:attempted-user; sid:28670; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash ActionDefineFunction memory access exploit attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"FWS|06|"; depth:4; content:"|43 02|"; within:27; byte_test:1,<,64,3,relative; content:"|03|"; within:1; distance:4; pcre:"/^(\x9B|\x8E)/R"; metadata:service smtp; reference:bugtraq,15334; reference:cve,2005-2628; classtype:attempted-user; sid:28669; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash ActionDefineFunction memory access exploit attempt"; flow:to_server,established; file_data; content:"|C0 C0 C0 C3 C8 E0 CC F4 9F 81 C1 86 79 B6 39 83 23 79 80 81 C1 81 81 81 01 00 F8 1C 12 25|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,15334; reference:cve,2005-2628; classtype:attempted-user; sid:28668; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionDefineFunction memory access exploit attempt"; flow:to_client,established; file_data; content:"|C0 C0 C0 C3 C8 E0 CC F4 9F 81 C1 86 79 B6 39 83 23 79 80 81 C1 81 81 81 01 00 F8 1C 12 25|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,15334; reference:cve,2005-2628; classtype:attempted-user; sid:28667; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH RealNetworks RealPlayer SWF flash file buffer overflow attempt"; flow:to_server,established; file_data; content:"|45 1C 8C 0C 40 C0 C8 C4 00 A2 99 98 19 98 80 14 0B 0B 03 33 90 E2 60 60 00 00 CF 20 4F 02|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,17202; reference:cve,2006-0323; classtype:attempted-user; sid:28666; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH RealNetworks RealPlayer SWF flash file buffer overflow attempt"; flow:to_client,established; file_data; content:"|45 1C 8C 0C 40 C0 C8 C4 00 A2 99 98 19 98 80 14 0B 0B 03 33 90 E2 60 60 00 00 CF 20 4F 02|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,17202; reference:cve,2006-0323; classtype:attempted-user; sid:28665; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH RealNetworks RealPlayer SWF flash file buffer overflow attempt"; flow:to_server,established; file_data; content:"|46 57 53 05 CF 00 00 00 60 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,17202; reference:cve,2006-0323; classtype:attempted-user; sid:28664; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player remote code execution attempt"; flow:to_server,established; file_data; content:"|DB BD 13 B7 93 13 DF EC A7 F9 32 92 4D 4C 86 B3 A1 F0 89 86 6F AC F7 64 7F 02 B6 EC 12 00|"; fast_pattern:only; metadata:service smtp; reference:cve,2009-1862; classtype:attempted-user; sid:28661; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player remote code execution attempt"; flow:to_client,established; file_data; content:"|DB BD 13 B7 93 13 DF EC A7 F9 32 92 4D 4C 86 B3 A1 F0 89 86 6F AC F7 64 7F 02 B6 EC 12 00|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-1862; classtype:attempted-user; sid:28660; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH RealNetworks RealPlayer SWF frame handling buffer overflow attempt"; flow:to_server,established; file_data; content:"|D5 DA E7 D5 CD 47 FA 57 75 38 2C 65 0E 37 00 34 7F 10 9A 1A 40 46 0F 00 FF 02 64 6E 6A 6E|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,30370; reference:cve,2007-5400; classtype:attempted-user; sid:28641; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH RealNetworks RealPlayer SWF frame handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|D5 DA E7 D5 CD 47 FA 57 75 38 2C 65 0E 37 00 34 7F 10 9A 1A 40 46 0F 00 FF 02 64 6E 6A 6E|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,30370; reference:cve,2007-5400; classtype:attempted-user; sid:28640; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player multimedia file DefineSceneAndFrameLabelData code execution attempt"; flow:to_server,established; file_data; content:"|FF AE E4 AB 67 DA E3 A4 A7 68 42 D1 59 0D 1A 58 BF 2C 00 A8 85 BF 27 C8 FF 00 A4 FF 5C 18|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:bugtraq,28695; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:28637; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player multimedia file DefineSceneAndFrameLabelData code execution attempt"; flow:to_client,established; file_data; content:"|FF AE E4 AB 67 DA E3 A4 A7 68 42 D1 59 0D 1A 58 BF 2C 00 A8 85 BF 27 C8 FF 00 A4 FF 5C 18|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,28695; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:28636; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player embedded JPG image height overflow attempt"; flow:to_server,established; file_data; content:"|03 83 82 89 EA 81 D6 82 85 31 E2 DB 79 DF 30 B4 B2 01 D3 2C 13 83 03 30 50 00 83 12 ED 1D|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-user; sid:28632; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player embedded JPG image height overflow attempt"; flow:to_client,established; file_data; content:"|03 83 82 89 EA 81 D6 82 85 31 E2 DB 79 DF 30 B4 B2 01 D3 2C 13 83 03 30 50 00 83 12 ED 1D|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-user; sid:28631; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player loadPCMFromByteArray bad sample count attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|16 7F 87 00 6C FB 86 D9 7C D5 E9 2A C7 63 DB 09|"; fast_pattern:only; metadata:service smtp; reference:cve,2012-5677; classtype:attempted-user; sid:28793; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player loadPCMFromByteArray bad sample count attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"loadPCMFromByteArray"; fast_pattern:only; content:"|80 07 4F 13 01 62 05 20 82 13 04 00 00 10 0A 00|"; metadata:service smtp; reference:cve,2012-5677; classtype:attempted-user; sid:28792; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player loadPCMFromByteArray bad sample count attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|16 7F 87 00 6C FB 86 D9 7C D5 E9 2A C7 63 DB 09|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-5677; classtype:attempted-user; sid:28791; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_client,established; flowbits:isset,file.swf|file.ole; file_data; content:"|86 06 E4 96 CA 82 03 D2 A8 AC 94 07 A8 9E DC D5 04 A6 E6 FC 9F 03 C0 D9 F2 89 06 FC 84 B0 81 02 C1 9F B7 18|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29054; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_server,established; flowbits:isset,file.swf|file.ole; file_data; content:"|86 06 E4 96 CA 82 03 D2 A8 AC 94 07 A8 9E DC D5 04 A6 E6 FC 9F 03 C0 D9 F2 89 06 FC 84 B0 81 02 C1 9F B7 18|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29053; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_server,established; flowbits:isset,file.swf|file.ole; file_data; content:"|44 F6 78 B2 2F 94 C5 8C 17 C2 C8 16 E0 1D B5 6D 52 D3 63 4D B4 97 AD B5 C4 DF C1 69 11 29 02 07 08 94 23 A1|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29052; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_client,established; flowbits:isset,file.swf|file.ole; file_data; content:"|44 F6 78 B2 2F 94 C5 8C 17 C2 C8 16 E0 1D B5 6D 52 D3 63 4D B4 97 AD B5 C4 DF C1 69 11 29 02 07 08 94 23 A1|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29051; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_server,established; flowbits:isset,file.swf|file.ole; file_data; content:"|08 06 8E 0F 00 00 01 00 02 2A 00 01 6D 79 67 67 66 00 0E 00 96 02 00 08 01 1C 96 04 00 08 03 04 01 4F 4F 96|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29050; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_client,established; flowbits:isset,file.swf|file.ole; file_data; content:"|08 06 8E 0F 00 00 01 00 02 2A 00 01 6D 79 67 67 66 00 0E 00 96 02 00 08 01 1C 96 04 00 08 03 04 01 4F 4F 96|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29049; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_server,established; flowbits:isset,file.swf|file.ole; file_data; content:"|E4 5E 12 3F 6F A2 06 46 BF 4C A2 52 9E D6 EC 56 7D 70 4F 69 0F 54 69 1D 77 77 46 31 3B 24 81 F3 BE 2F A1 AB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29048; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player and AIR type confusion remote code execution attempt"; flow:to_client,established; flowbits:isset,file.swf|file.ole; file_data; content:"|E4 5E 12 3F 6F A2 06 46 BF 4C A2 52 9E D6 EC 56 7D 70 4F 69 0F 54 69 1D 77 77 46 31 3B 24 81 F3 BE 2F A1 AB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64199; reference:cve,2013-5331; reference:url,helpx.adobe.com/security/products/flash-player/apsb13-28.html; reference:url,osvdb.org/show/osvdb/100774; classtype:attempted-user; sid:29047; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|0B 30 0A 51 44 12 2F 4B 28 85 48 2A 95 42 39 5E 46 28 8D 32|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5329; classtype:attempted-user; sid:29288; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|87 01 BB 65 65 2C D4 40 1F 41 79 8F AC DC BA 0F F9 A3 C8 1F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5329; classtype:attempted-user; sid:29287; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|0B 30 0A 51 44 12 2F 4B 28 85 48 2A 95 42 39 5E 46 28 8D 32|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5329; classtype:attempted-user; sid:29286; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|87 01 BB 65 65 2C D4 40 1F 41 79 8F AC DC BA 0F F9 A3 C8 1F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5329; classtype:attempted-user; sid:29285; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"ByteArrayAsset"; fast_pattern:only; content:"mx.core"; content:"|FF 15|"; content:"|00 00 00 00|"; within:4; distance:6; byte_jump:4,-10,relative,little; content:"|14|"; within:1; byte_extract:4,0,ABCLength,relative,little; content:"ByteArrayAsset"; within:ABCLength; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5329; classtype:attempted-user; sid:29284; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"ByteArrayAsset"; fast_pattern:only; content:"mx.core"; content:"|15|"; byte_test:2,&,0x15c0,-2,relative; byte_test:1,!=,0x3f,-1,relative; content:"|00 00 00 00|"; within:4; distance:2; content:"|14|"; within:62; distance:4; byte_extract:4,0,ABCLength,relative,little; content:"ByteArrayAsset"; within:ABCLength; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5329; classtype:attempted-user; sid:29283; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"ByteArrayAsset"; fast_pattern:only; content:"mx.core"; content:"|FF 15|"; content:"|00 00 00 00|"; within:4; distance:6; byte_jump:4,-10,relative,little; content:"|14|"; within:1; byte_extract:4,0,ABCLength,relative,little; content:"ByteArrayAsset"; within:ABCLength; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5329; classtype:attempted-user; sid:29282; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player sharable ByteArray code execution attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"ByteArrayAsset"; fast_pattern:only; content:"mx.core"; content:"|15|"; byte_test:2,&,0x15c0,-2,relative; byte_test:1,!=,0x3f,-1,relative; content:"|00 00 00 00|"; within:4; distance:2; content:"|14|"; within:62; distance:4; byte_extract:4,0,ABCLength,relative,little; content:"ByteArrayAsset"; within:ABCLength; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5329; classtype:attempted-user; sid:29281; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player invalid instruction memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|38 C8 1F CC E7 2D 7B B7 50 BC 73 E7 4E 41 99 2B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5330; reference:url,www.adobe.com/support/security/bulletins/apsb13-26.html; classtype:attempted-user; sid:29554; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player invalid instruction memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|0A A2 15 AB FF FF 02 62 07 37 76 2A 12 14 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-5330; reference:url,www.adobe.com/support/security/bulletins/apsb13-26.html; classtype:attempted-user; sid:29553; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player invalid instruction memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|38 C8 1F CC E7 2D 7B B7 50 BC 73 E7 4E 41 99 2B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5330; reference:url,www.adobe.com/support/security/bulletins/apsb13-26.html; classtype:attempted-user; sid:29552; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player invalid instruction memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|0A A2 15 AB FF FF 02 62 07 37 76 2A 12 14 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5330; reference:url,www.adobe.com/support/security/bulletins/apsb13-26.html; classtype:attempted-user; sid:29551; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe FlashPlayer loadPCMFromByteArray bad sample count attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|A4 69 02 21 21 ED 61 DD 75 52 5A 8A 76 65 CB 3A|"; fast_pattern:only; metadata:service smtp; reference:cve,2012-5677; classtype:attempted-user; sid:29525; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe FlashPlayer loadPCMFromByteArray bad sample count attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|A4 69 02 21 21 ED 61 DD 75 52 5A 8A 76 65 CB 3A|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-5677; classtype:attempted-user; sid:29524; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player integer underflow attempt"; flow:to_client,established; file_data; content:"|17 2C 11 64 D8 27 80 D3 C2 F8 C5 C4 0E 77 7F 0A E5 95 E0 C3 B9 80 36 C6 09 3E CB 05 92 20 49 B2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0497; classtype:attempted-user; sid:29634; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player integer underflow attempt"; flow:to_server,established; file_data; content:"|17 2C 11 64 D8 27 80 D3 C2 F8 C5 C4 0E 77 7F 0A E5 95 E0 C3 B9 80 36 C6 09 3E CB 05 92 20 49 B2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0497; classtype:attempted-user; sid:29633; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player integer underflow attempt"; flow:to_server,established; file_data; content:"|04 5B 04 05 F6 08 E0 B6 D1 7E 31 B9 C5 33 90 46 7A 35 34 E1 5C 40 19 C3 84 26 5B 06 49 90 24 45|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0497; classtype:attempted-user; sid:29632; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player integer underflow attempt"; flow:to_client,established; file_data; content:"|04 5B 04 05 F6 08 E0 B6 D1 7E 31 B9 C5 33 90 46 7A 35 34 E1 5C 40 19 C3 84 26 5B 06 49 90 24 45|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0497; classtype:attempted-user; sid:29631; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash ActionScript bytecode object type confusion information disclosure attempt"; flow:to_server,established; file_data; content:"|D0 30 24 00 74 D6 24 00 74 D7 24 00 74 63 04 5D 09 5D 08 D1 4A 08 01 4A 09 01 75 63 05 5D 01 4A 01 00 80 01 2A 63 06 62 05 4F 0A 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0492; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-02.html; classtype:attempted-recon; sid:29836; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash ActionScript bytecode object type confusion information disclosure attempt"; flow:to_client,established; file_data; content:"|D0 30 24 00 74 D6 24 00 74 D7 24 00 74 63 04 5D 09 5D 08 D1 4A 08 01 4A 09 01 75 63 05 5D 01 4A 01 00 80 01 2A 63 06 62 05 4F 0A 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0492; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-02.html; classtype:attempted-recon; sid:29835; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash regular expression grouping depth buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"RegExp"; nocase; content:"|28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28|"; within:50; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,65703; reference:cve,2011-2134; reference:cve,2014-0499; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:29934; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player PCRE regexp out of bounds memory leak ASLR bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|6E A3 85 65 0A 3E 0D C3 E8 92 5E 5D CA 34 B4 66 04 14 EF 8E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,65703; reference:cve,2014-0499; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29933; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player PCRE regexp out of bounds memory leak ASLR bypass attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|6E A3 85 65 0A 3E 0D C3 E8 92 5E 5D CA 34 B4 66 04 14 EF 8E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65703; reference:cve,2014-0499; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29932; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player worker shared object user-after-free attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|39 D7 B9 4D F6 E4 1C 4A 67 00 6D 8B DE D2 DF 77|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0502; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29931; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player worker shared object user-after-free attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|16 08 18 0A 16 0C 16 14 16 1D 17 06 05 00 05 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0502; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29930; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player worker shared object user-after-free attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|39 D7 B9 4D F6 E4 1C 4A 67 00 6D 8B DE D2 DF 77|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0502; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29929; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player worker shared object user-after-free attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|16 08 18 0A 16 0C 16 14 16 1D 17 06 05 00 05 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0502; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29928; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|D3 83 C3 23 EA 4E 54 59 7B D7 CF AD 7F 68 76 7C 76 DD D3 F5 CF D4 ED 02 C5 29 CC F0 50 DD 82 BA|"; metadata:policy balanced-ips alert, policy security-ips drop, service smtp; reference:cve,2014-0498; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29927; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|D3 83 C3 23 EA 4E 54 59 7B D7 CF AD 7F 68 76 7C 76 DD D3 F5 CF D4 ED 02 C5 29 CC F0 50 DD 82 BA|"; metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0498; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:29926; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash incorrect null uri character normalization attempt"; flow:to_server,established; file_data; content:"<embed"; content:"src"; within:200; content:"%2500"; within:200; content:".swf"; within:200; pcre:"/src\s*=\s*[\x22\x27][^\x22\x27]*?\x252500[^\x22\x27]*?\.swf[\x22\x27]/"; metadata:policy security-ips alert, service smtp; reference:cve,2014-0503; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-08.html; classtype:attempted-user; sid:30149; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash incorrect null uri character normalization attempt"; flow:to_client,established; file_data; content:"<embed"; content:"src"; within:200; content:"%2500"; within:200; content:".swf"; within:200; pcre:"/src\s*=\s*[\x22\x27][^\x22\x27]*?\x252500[^\x22\x27]*?\.swf[\x22\x27]/"; metadata:policy security-ips alert, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0503; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-08.html; classtype:attempted-user; sid:30148; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash incorrect null uri character normalization attempt"; flow:to_server,established; file_data; content:"<embed"; content:"src"; within:200; content:"%00"; within:200; content:".swf"; within:200; pcre:"/src\s*=\s*[\x22\x27][^\x22\x27]*?\x2500[^\x22\x27]*?\.swf[\x22\x27]/"; metadata:policy security-ips alert, service smtp; reference:cve,2014-0503; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-08.html; classtype:attempted-user; sid:30147; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash incorrect null uri character normalization attempt"; flow:to_client,established; file_data; content:"<embed"; content:"src"; within:200; content:"%00"; within:200; content:".swf"; within:200; pcre:"/src\s*=\s*[\x22\x27][^\x22\x27]*?\x2500[^\x22\x27]*?\.swf[\x22\x27]/"; metadata:policy security-ips alert, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0503; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-08.html; classtype:attempted-user; sid:30146; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player JPEG parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|FF D8 FF E0|"; content:"JFIF|00|"; within:5; distance:2; content:"|FF C0|"; within:2; distance:9; byte_test:2,>,0x7fff,5,relative; metadata:service smtp; reference:cve,2009-3794; classtype:attempted-user; sid:30349; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player JPEG parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|FF D8 FF E0|"; content:"JFIF|00|"; within:5; distance:2; content:"|FF C0|"; within:2; distance:9; byte_test:2,>,0x7fff,3,relative; metadata:service smtp; reference:cve,2009-3794; classtype:attempted-user; sid:30348; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player JPEG parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|FF D8 FF E0|"; content:"JFIF|00|"; within:5; distance:2; content:"|FF C0|"; within:2; distance:9; byte_test:2,>,0x7fff,5,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3794; classtype:attempted-user; sid:30347; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player navigateToUrl hidden channel to file creation"; flow:to_server,established; file_data; content:".replace|28|"; nocase; content:"/5C/g"; within:10; nocase; content:".replace|28|"; within:100; nocase; content:"/2F/g"; within:10; nocase; content:".replace|28|"; within:100; nocase; content:"/%/g"; within:10; nocase; content:"localStorage.file"; within:100; fast_pattern; metadata:service smtp; reference:cve,2014-0508; classtype:attempted-user; sid:30540; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player navigateToUrl hidden channel to file creation"; flow:to_client,established; file_data; content:".replace|28|"; nocase; content:"/5C/g"; within:10; nocase; content:".replace|28|"; within:100; nocase; content:"/2F/g"; within:10; nocase; content:".replace|28|"; within:100; nocase; content:"/%/g"; within:10; nocase; content:"localStorage.file"; within:100; fast_pattern; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-0508; classtype:attempted-user; sid:30539; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malformed HTML text null dereference attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|7E F0 ED B8 1F 86 3B E8 6E EC 1E DA BD 9C EA AD F7 0A 5E 43|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,66208; reference:cve,2014-0506; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; classtype:attempted-user; sid:30538; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malformed HTML text null dereference attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|61 6C 49 6E 74 65 72 66 61 63 65 07 65 78 70 6C 6F 69 74 06|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,66208; reference:cve,2014-0506; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; classtype:attempted-user; sid:30537; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malformed HTML text null dereference attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|61 6C 49 6E 74 65 72 66 61 63 65 07 65 78 70 6C 6F 69 74 06|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66208; reference:cve,2014-0506; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; classtype:attempted-user; sid:30536; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malformed HTML text null dereference attempt"; flow:to_client,established; flowbits:isset,file.cws; file_data; content:"|7E F0 ED B8 1F 86 3B E8 6E EC 1E DA BD 9C EA AD F7 0A 5E 43|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66208; reference:cve,2014-0506; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; classtype:attempted-user; sid:30535; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_server,established; file_data; content:"|A7 DC 72 96 8E 0A E7 DC A7 EB D4 AC 8E 8D B9 52 53 8D 33 47 95 16 6B 68 5A 2E 5A 95 86 EA|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:30755; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_client,established; file_data; content:"|A7 DC 72 96 8E 0A E7 DC A7 EB D4 AC 8E 8D B9 52 53 8D 33 47 95 16 6B 68 5A 2E 5A 95 86 EA|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,57787; reference:cve,2013-0634; reference:url,osvdb.org/show/osvdb/89937; reference:url,www.adobe.com/support/security/bulletins/apsb13-04.html; classtype:attempted-user; sid:30754; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player SWF ActionScript exploit attempt"; flow:to_server,established; file_data; content:"|86 A1 54 55 EE BB 0C F2 A8 D7 27 22 AF 0D 4C 8D 2B 85 3A 2C 05 42 6A BE 76 4C 58 65 02 17 EB 3F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0507; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; classtype:attempted-user; sid:30846; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player SWF ActionScript exploit attempt"; flow:to_client,established; file_data; content:"|86 A1 54 55 EE BB 0C F2 A8 D7 27 22 AF 0D 4C 8D 2B 85 3A 2C 05 42 6A BE 76 4C 58 65 02 17 EB 3F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0507; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; classtype:attempted-user; sid:30845; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Acrobat Reader cross-site scripting attempt"; flow:to_server,established; content:".swf"; http_raw_uri; content:"%ED%A0%80%5C"; distance:0; http_raw_uri; metadata:service http; reference:bugtraq,66703; reference:cve,2014-0509; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; reference:url,osvdb.org/show/osvdb/105537; classtype:attempted-user; sid:30844; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"FILE-FLASH Adobe Acrobat Reader cross-site scripting attempt"; flow:to_server,established; content:".swf"; http_raw_uri; content:"%ED%A0%80|5C|"; distance:0; http_raw_uri; metadata:service http; reference:bugtraq,66703; reference:cve,2014-0509; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-09.html; reference:url,osvdb.org/show/osvdb/105537; classtype:attempted-user; sid:30843; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|9E F0 A0 C5 BC 7B F7 EE ED 6E 86 16 48 08 2E 14 62 11 5E 02 E0 ED 4E 95 F5 0D B4 65 41 C9 EF 64|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0510; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31026; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|9E F0 A0 C5 BC 7B F7 EE ED 6E 86 16 48 08 2E 14 62 11 5E 02 E0 ED 4E 95 F5 0D B4 65 41 C9 EF 64|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0510; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31025; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|0D 01 D0 66 06 60 02 66 0E D0 66 0B 4F 0F 02 D0|"; fast_pattern:only; content:"|66 06 D0 66 07 4F 0D 01 D0 66 05 24 00 4F 10 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0510; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31024; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|0D 01 D0 66 06 60 02 66 0E D0 66 0B 4F 0F 02 D0|"; fast_pattern:only; content:"|66 06 D0 66 07 4F 0D 01 D0 66 05 24 00 4F 10 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0510; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31023; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_server,established; file_data; content:"{|00|7|00|3|00|c|00|9|00|d|00|f|00|a|00|0|00|-|00|7|00|5|00|0|00|d|00|-|00|1|00|1|00|e|00|1|00|-|00|b|00|0|00|c|00|4|00|-|00|0|00|8|00|0|00|0|00|2|00|0|00|0|00|c|00|9|00|a|00|6|00|6|00|}|00|"; fast_pattern:only; content:"d|00|i|00|g|00|e|00|s|00|t|00|.|00|s|00|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0518; reference:cve,2014-0520; reference:url,adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31246; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash malformed regular expression exploit attempt"; flow:to_client,established; file_data; content:"{|00|7|00|3|00|c|00|9|00|d|00|f|00|a|00|0|00|-|00|7|00|5|00|0|00|d|00|-|00|1|00|1|00|e|00|1|00|-|00|b|00|0|00|c|00|4|00|-|00|0|00|8|00|0|00|0|00|2|00|0|00|0|00|c|00|9|00|a|00|6|00|6|00|}|00|"; fast_pattern:only; content:"d|00|i|00|g|00|e|00|s|00|t|00|.|00|s|00|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0518; reference:cve,2014-0520; reference:url,adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31245; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Microsoft Internet Explorer sandbox escape attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Usage: InjectDll"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0517; reference:cve,2014-9150; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; reference:url,helpx.adobe.com/security/products/reader/apsb14-28.html; classtype:attempted-admin; sid:31286; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Microsoft Internet Explorer sandbox escape attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"ExploitFlashBroker_Canonicalization.pdb"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0517; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-admin; sid:31285; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Microsoft Internet Explorer sandbox escape attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Usage: InjectDll"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0517; reference:cve,2014-9150; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; reference:url,helpx.adobe.com/security/products/reader/apsb14-28.html; classtype:attempted-admin; sid:31284; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Microsoft Internet Explorer sandbox escape attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"ExploitFlashBroker_Canonicalization.pdb"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0517; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-admin; sid:31283; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player redirect attempt"; flow:to_client,established; file_data; content:"|92 46 59 93 3A 52 CC 52 8E 8C 03 78 FE EE DA D0 87 FC 33 97 9A|"; fast_pattern:only; content:"|96 9C F8 6E FA A7 24 F2 54 9E 1D 04 76 20 73 F8 ED DE 74 92 5B|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,67970; reference:cve,2014-0535; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/106909; classtype:attempted-user; sid:31282; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player redirect attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|92 46 59 93 3A 52 CC 52 8E 8C 03 78 FE EE DA D0 87 FC 33 97 9A|"; fast_pattern:only; content:"|96 9C F8 6E FA A7 24 F2 54 9E 1D 04 76 20 73 F8 ED DE 74 92 5B|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,67970; reference:cve,2014-0535; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/106909; classtype:attempted-user; sid:31281; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe AS3 decompressed pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"flash.display"; content:"RegExp"; distance:0; fast_pattern; content:"|28 3F 3D|"; within:10; pcre:"/\x28\x3f\x3d[^)]{300}/"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31354; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe AS3 decompressed pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"flash.display"; content:"RegExp"; distance:0; fast_pattern; content:"|28 3F 3D|"; within:10; pcre:"/\x28\x3f\x3d[^)]{300}/"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31353; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe AS3 decompressed pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"flash.display"; content:"RegExp"; distance:0; content:"|28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D|"; within:65; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31352; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe AS3 decompressed pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"flash.display"; content:"RegExp"; distance:0; content:"|28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D 28 3F 3D|"; within:65; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31351; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe AS3 simplified pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; content:"|FB 62 54 C9 C3 D8 7F 2E A8 7D 9E 48 31 F2 43 19 4D 44 F1 D2 F8 C7 5B C3 44 2A 57 31 32 6F D3 51 24 85 19 8B A4 27 FB E6 8D E8 9D 3E A5 C6 20 F7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31350; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe AS3 simplified pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; content:"|FB 62 54 C9 C3 D8 7F 2E A8 7D 9E 48 31 F2 43 19 4D 44 F1 D2 F8 C7 5B C3 44 2A 57 31 32 6F D3 51 24 85 19 8B A4 27 FB E6 8D E8 9D 3E A5 C6 20 F7|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31349; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe AS3 pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; content:"|D7 C6 6E C9 B7 F6 2D BB 37 7A C5 18 65 1C CD C5 88 D8 E7 19 BF 30 B6 6E 22 AB E5 A3 16 2E 55 EF 05 6B A7 71 50 23 22 B8 74 17 1D C8 B9 94 9C 53|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31348; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe AS3 pcre assertion out of bounds corruption attempt"; flow:to_client,established; file_data; content:"|D7 C6 6E C9 B7 F6 2D BB 37 7A C5 18 65 1C CD C5 88 D8 E7 19 BF 30 B6 6E 22 AB E5 A3 16 2E 55 EF 05 6B A7 71 50 23 22 B8 74 17 1D C8 B9 94 9C 53|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0536; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,www.securityfocus.com/bid/67961; classtype:attempted-user; sid:31347; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe JSONP callback API vulnerability exploitation attempt"; flow:to_client,established; file_data; content:"application/x-shockwave-flash"; nocase; content:"codebase="; within:200; nocase; content:"http"; within:6; content:"callback="; within:200; fast_pattern; content:"ws"; within:3; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4671; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:attempted-user; sid:31397; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe JSONP callback API vulnerability exploitation attempt"; flow:to_client,established; file_data; content:"application/x-shockwave-flash"; nocase; content:"archive="; within:200; nocase; content:"http"; within:6; content:"callback="; within:200; fast_pattern; content:"ws"; within:3; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4671; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:attempted-user; sid:31396; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe JSONP callback API vulnerability exploitation attempt"; flow:to_server,established; file_data; content:"application/x-shockwave-flash"; nocase; content:"codebase="; within:200; nocase; content:"http"; within:6; content:"callback="; within:200; fast_pattern; content:"ws"; within:3; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4671; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:attempted-user; sid:31395; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe JSONP callback API vulnerability exploitation attempt"; flow:to_server,established; file_data; content:"application/x-shockwave-flash"; nocase; content:"archive="; within:200; nocase; content:"http"; within:6; content:"callback="; within:200; fast_pattern; content:"ws"; within:3; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4671; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:attempted-user; sid:31394; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe JSONP callback API vulnerability exploitation attempt"; flow:to_server,established; file_data; content:"application/x-shockwave-flash"; nocase; content:"data="; within:200; nocase; content:"http"; within:6; content:"callback="; within:200; fast_pattern; content:"ws"; within:3; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4671; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:attempted-user; sid:31393; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe JSONP callback API vulnerability exploitation attempt"; flow:to_client,established; file_data; content:"application/x-shockwave-flash"; nocase; content:"data="; within:200; nocase; content:"http"; within:6; content:"callback="; within:200; fast_pattern; content:"ws"; within:3; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4671; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:attempted-user; sid:31392; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player Microsoft Internet Explorer sandbox escape attempt"; flow:to_server,established; file_data; content:"ExploitFlashBroker_ShortFileName.pdb"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0519; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-admin; sid:31496; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player Microsoft Internet Explorer sandbox escape attempt"; flow:to_client,established; file_data; content:"ExploitFlashBroker_ShortFileName.pdb"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0519; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-admin; sid:31495; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player security sandbox bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|F7 98 89 2B 18 31 4C 5D EA 5B 06 EF C8 1D 66 B5 3B 3C 4E 0D 63 A7 63 D9 86 32 0A 76 18 57 BE 3E A8 56 5D 6A|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,67963; reference:cve,2014-0534; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/107823; classtype:policy-violation; sid:31494; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player security sandbox bypass attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|F7 98 89 2B 18 31 4C 5D EA 5B 06 EF C8 1D 66 B5 3B 3C 4E 0D 63 A7 63 D9 86 32 0A 76 18 57 BE 3E A8 56 5D 6A|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,67963; reference:cve,2014-0534; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/107823; classtype:policy-violation; sid:31493; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player security sandbox bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|0F 97 23 BE 53 7B FE 75 B5 5C 2F CF 00 37 DA DA AA 05 33 3A CC 27 96 5B 0E 17 2F DA 40 97 39 F5 DB 8C 8B 70|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,67963; reference:cve,2014-0534; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/107823; classtype:policy-violation; sid:31492; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player security sandbox bypass attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|0F 97 23 BE 53 7B FE 75 B5 5C 2F CF 00 37 DA DA AA 05 33 3A CC 27 96 5B 0E 17 2F DA 40 97 39 F5 DB 8C 8B 70|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,67963; reference:cve,2014-0534; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/107823; classtype:policy-violation; sid:31491; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player security sandbox bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"Security.sandboxType"; content:"LOCAL_WITH_FILE"; fast_pattern:only; content:"URLLoader|0A|URLRequest"; content:"navigateToURL"; metadata:service smtp; reference:bugtraq,67963; reference:cve,2014-0534; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/107823; classtype:policy-violation; sid:31490; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player security sandbox bypass attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"Security.sandboxType"; content:"LOCAL_WITH_FILE"; fast_pattern:only; content:"URLLoader|0A|URLRequest"; content:"navigateToURL"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,67963; reference:cve,2014-0534; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; reference:url,osvdb.org/show/osvdb/107823; classtype:policy-violation; sid:31489; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player pcast scheme security sandbox bypass attempt"; flow:established,to_server; flowbits:isset,file.swf; file_data; content:"localsandbox_bypass"; fast_pattern:only; content:"URLLoader|0A|URLRequest"; content:"pcast:http"; within:15; content:"sendToURL"; within:100; metadata:service smtp; reference:bugtraq,68454; reference:cve,2013-0539; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:policy-violation; sid:31554; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player feed scheme security sandbox bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|65 6C 6E 53 2B 69 76 56 73 39 79 70 45 4B 56 6C 72 54 43 2B 75 61 2F 72|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,68454; reference:cve,2013-0539; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:policy-violation; sid:31553; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player feed scheme security sandbox bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"localsandbox_bypass"; fast_pattern:only; content:"URLLoader|0A|URLRequest"; content:"feed:http"; within:15; content:"sendToURL"; within:100; metadata:service smtp; reference:bugtraq,68454; reference:cve,2013-0539; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:policy-violation; sid:31552; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player pcast scheme security sandbox bypass attempt"; flow:established,to_client; flowbits:isset,file.swf; file_data; content:"localsandbox_bypass"; fast_pattern:only; content:"URLLoader|0A|URLRequest"; content:"pcast:http"; within:15; content:"sendToURL"; within:100; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,68454; reference:cve,2013-0539; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:policy-violation; sid:31551; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player feed scheme security sandbox bypass attempt"; flow:established,to_client; flowbits:isset,file.swf; file_data; content:"|9F 58 96 10 02 0F 64 F9 B4 C9 0A 68 04 E5 43 A2 75 24 9D 72 DB 4C 45 BD|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,68454; reference:cve,2013-0539; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:policy-violation; sid:31550; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player feed scheme security sandbox bypass attempt"; flow:established,to_client; flowbits:isset,file.swf; file_data; content:"localsandbox_bypass"; fast_pattern:only; content:"URLLoader|0A|URLRequest"; content:"feed:http"; within:15; content:"sendToURL"; within:100; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,68454; reference:cve,2013-0539; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-17.html; classtype:policy-violation; sid:31549; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player cross-origin security policy bypass attempt"; flow:to_server,established; flowbits:isset,file.swf|file.cws; file_data; content:"|04 00 00 78 DA 5D 53 DB 6E D3 30 18 B6 93 B4 6E BB 75 EB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,67361; reference:cve,2014-0516; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:policy-violation; sid:31685; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player cross-origin security policy bypass attempt"; flow:to_client,established; flowbits:isset,file.swf|file.cws; file_data; content:"|04 00 00 78 DA 5D 53 DB 6E D3 30 18 B6 93 B4 6E BB 75 EB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,67361; reference:cve,2014-0516; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:policy-violation; sid:31684; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash valueOf memory leak attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|21 87 78 41 C4 91 68 6C 24 3E 1A BF AE E5 A2 22 C4 68 1C 8F 8A F3 08 72 18 25 F1 D8 0D 8C 26 A3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service smtp; reference:cve,2014-0540; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:attempted-recon; sid:31679; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash valueOf memory leak attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|21 87 78 41 C4 91 68 6C 24 3E 1A BF AE E5 A2 22 C4 68 1C 8F 8A F3 08 72 18 25 F1 D8 0D 8C 26 A3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0540; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:attempted-recon; sid:31678; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Broker write to junction exploit attempt"; flow:to_server,established; file_data; flowbits:isset,file.junction; content:"{|00|7|00|3|00|c|00|9|00|d|00|f|00|a|00|0|00|-|00|7|00|5|00|0|00|d|00|-|00|1|00|1|00|e|00|1|00|-|00|b|00|0|00|c|00|4|00|-|00|0|00|8|00|0|00|0|00|2|00|0|00|0|00|c|00|9|00|a|00|6|00|6|00|}|00|"; fast_pattern:only; content:"|5C 00|?|00|?|00 5C 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0518; reference:cve,2014-0520; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31677; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Broker write to junction exploit attempt"; flow:to_server,established; file_data; flowbits:set,file.junction; content:"|03 00 00 A0|"; content:"|A4 00 09 00|"; flowbits:noalert; metadata:service smtp; reference:cve,2014-0518; reference:cve,2014-0520; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31676; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Broker write to junction exploit attempt"; flow:to_client,established; file_data; flowbits:set,file.junction; content:"|03 00 00 A0|"; content:"|A4 00 09 00|"; flowbits:noalert; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-0518; reference:cve,2014-0520; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31675; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Broker write to junction exploit attempt"; flow:to_client,established; file_data; flowbits:isset,file.junction; content:"{|00|7|00|3|00|c|00|9|00|d|00|f|00|a|00|0|00|-|00|7|00|5|00|0|00|d|00|-|00|1|00|1|00|e|00|1|00|-|00|b|00|0|00|c|00|4|00|-|00|0|00|8|00|0|00|0|00|2|00|0|00|0|00|c|00|9|00|a|00|6|00|6|00|}|00|"; fast_pattern:only; content:"|5C 00|?|00|?|00 5C 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0518; reference:cve,2014-0520; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-14.html; classtype:attempted-user; sid:31674; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"FILE-FLASH Adobe Flash Player URL handling remote code execution attempt"; flow:to_server,established; content:".swf?"; fast_pattern:only; http_uri; pcre:"/\.swf\?\w+?=(https?|ftps?)?\x5C{2}(\x2F\D:\x2F)/Ii"; metadata:service http; reference:bugtraq,69191; reference:cve,2014-0541; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:attempted-admin; sid:31673; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory leak ASLR bypass attempt"; flow:to_client,established; file_data; content:"FWS"; depth:3; content:"|05 77 05 00 00 01 00 03 40 00 40 00 FF 08 1D 01 00 03 FF FC 00 00 00 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0544; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:policy-violation; sid:31726; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory leak ASLR bypass attempt"; flow:to_server,established; file_data; content:"FWS"; depth:3; fast_pattern; content:"|3F 05|"; distance:22; byte_test:1,>=,3,6,relative,little; byte_test:1,<=,5,6,relative,little; byte_jump:4,0,relative,little,align; isdataat:5,relative; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:-9; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0544; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:policy-violation; sid:31725; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player memory leak ASLR bypass attempt"; flow:to_server,established; file_data; content:"FWS"; depth:3; content:"|05 77 05 00 00 01 00 03 40 00 40 00 FF 08 1D 01 00 03 FF FC 00 00 00 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0544; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:policy-violation; sid:31724; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player memory leak ASLR bypass attempt"; flow:to_client,established; file_data; content:"FWS"; depth:3; fast_pattern; content:"|3F 05|"; distance:22; byte_test:1,>=,3,6,relative,little; byte_test:1,<=,5,6,relative,little; byte_jump:4,0,relative,little,align; isdataat:5,relative; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:-9; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0544; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:policy-violation; sid:31723; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player MMgc use-after-free attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|B0 AE 21 46 B6 BE 69 98 BF 3A 5C 19 18 56 15 AE 1B 7E A1 BF 61 F8 88 61|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0538; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; reference:url,www.securityfocus.com/bid/69192; classtype:attempted-user; sid:31733; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player MMgc use-after-free attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|B0 AE 21 46 B6 BE 69 98 BF 3A 5C 19 18 56 15 AE 1B 7E A1 BF 61 F8 88 61|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0538; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; reference:url,www.securityfocus.com/bid/69192; classtype:attempted-user; sid:31732; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player corrupt image memory leak"; flow:to_client,established; file_data; content:"FWS"; depth:3; content:"|BF 16|"; distance:28; byte_jump:4,6,relative,little; content:"|00 00|"; within:20; metadata:policy security-ips drop, service smtp; reference:bugtraq,69197; reference:cve,2014-0545; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:attempted-user; sid:31740; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player corrupt image memory leak"; flow:to_client,established; file_data; content:"FWS"; depth:3; content:"|BF 16|"; distance:28; byte_jump:4,6,relative,little; content:"|00 00|"; within:20; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,69197; reference:cve,2014-0545; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:attempted-user; sid:31739; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player marshallException through JavaScript XSS attempt"; flow:to_server,established; file_data; content:".swf"; fast_pattern; nocase; content:"throwException"; distance:0; nocase; content:"sendDataToJS"; within:300; nocase; pcre:"/var\s+?(?P<unesc>\w+?)\s*?=\s*?([^'"]|['"])+?[^>]*?throwException\s*?\(\s*?(?P=unesc)\s*?\)[^\r]*?sendDataToJS\s*?\(\s*?(?P=unesc)\s*?\)/i"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,67962; reference:cve,2014-0531; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:31750; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player marshallException through JavaScript XSS attempt"; flow:to_client,established; file_data; content:".swf"; fast_pattern; nocase; content:"throwException"; distance:0; nocase; content:"sendDataToJS"; within:300; nocase; pcre:"/var\s+?(?P<unesc>\w+?)\s*?=\s*?([^'"]|['"])+?[^>]*?throwException\s*?\(\s*?(?P=unesc)\s*?\)[^\r]*?sendDataToJS\s*?\(\s*?(?P=unesc)\s*?\)/i"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,67962; reference:cve,2014-0531; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:31749; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player local-with-file-access security bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|FF FC 81 D9 83 07 0E 1E DC 1F 14 FD 83 B3 6A EA 3D D7 F4 AF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0554; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31842; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player local-with-file-access security bypass attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"proxy_fla"; nocase; content:"file:///"; fast_pattern:only; content:"toLowerCase"; nocase; content:"toUpperCase"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0554; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31841; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player local-with-file-access security bypass attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|FF FC 81 D9 83 07 0E 1E DC 1F 14 FD 83 B3 6A EA 3D D7 F4 AF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0554; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31840; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player local-with-file-access security bypass attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"proxy_fla"; nocase; content:"file:///"; fast_pattern:only; content:"toLowerCase"; nocase; content:"toUpperCase"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0554; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31839; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player corrupt image memory leak"; flow:to_client,established; file_data; content:"|FF D8 FF|"; depth:3; fast_pattern; content:"|FF C0|"; offset:2; content:"|08|"; within:1; distance:2; content:!"|00 00 00 00|"; within:4; content:!"|01|"; within:1; distance:4; content:!"|03|"; within:1; distance:4; content:!"|04|"; within:1; distance:4; metadata:service smtp; reference:bugtraq,69194; reference:cve,2014-0542; classtype:attempted-user; sid:31862; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player corrupt image memory leak"; flow:to_client,established; file_data; content:"|FF D8 FF|"; depth:3; fast_pattern; content:"|FF C0|"; offset:2; content:"|08|"; within:1; distance:2; content:!"|00 00 00 00|"; within:4; content:!"|01|"; within:1; distance:4; content:!"|03|"; within:1; distance:4; content:!"|04|"; within:1; distance:4; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,69194; reference:cve,2014-0542; classtype:attempted-user; sid:31861; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player RegExp compilation heap overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|B9 74 64 46 31 F5 52 97 D7 D4 E7 52 59 F0 DD 10 21 11 A5 BD C0 4F 86 24|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0559; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31850; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player RegExp compilation heap overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"RegExp<((?i)((?i)(?J)WMLIANG(?-J)(?-i)|7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C|)(?-i))"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0559; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31849; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player RegExp compilation heap overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|B9 74 64 46 31 F5 52 97 D7 D4 E7 52 59 F0 DD 10 21 11 A5 BD C0 4F 86 24|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0559; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31848; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player RegExp compilation heap overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"RegExp<((?i)((?i)(?J)WMLIANG(?-J)(?-i)|7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C 7C|)(?-i))"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0559; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:31847; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player invalid TRCK frame attempt"; flow:to_client,established; file_data; content:"ID3"; depth:3; content:"TRCK|00 00 00 01 00 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:bugtraq,69703; reference:cve,2014-0552; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32027; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player invalid TRCK frame attempt"; flow:to_client,established; file_data; content:"ID3"; depth:3; content:"TRCK|00 00 00 01 00 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,69703; reference:cve,2014-0552; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32026; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player unsupported bitmapFormat value memory disclosure attempt"; flow:to_client,established; file_data; content:"|3F 05 77 05 00 00 01 00 00 40 00 40 00 01 08 1D 01 06 02 F9 FD 00 00 00 FF|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,69195; reference:cve,2014-0543; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:attempted-user; sid:32025; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player unsupported bitmapFormat value memory disclosure attempt"; flow:to_client,established; file_data; content:"|3F 05 77 05 00 00 01 00 00 40 00 40 00 01 08 1D 01 06 02 F9 FD 00 00 00 FF|"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,69195; reference:cve,2014-0543; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-18.html; classtype:attempted-user; sid:32024; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash copyPixelsToByteArray integer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|7D 6E 5C 23 7A DD 21 75 5A D8 7C E6 C5 AE 6C 2F 47 C2 68 61 D7 D1 C4 EC D2 13 31 27 67 97 FC 34|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0556; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32098; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash copyPixelsToByteArray integer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|7D 6E 5C 23 7A DD 21 75 5A D8 7C E6 C5 AE 6C 2F 47 C2 68 61 D7 D1 C4 EC D2 13 31 27 67 97 FC 34|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0556; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32097; rev:1;)
alert tcp $EXTERNAL_NET 1935 -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player RTMP ping abort message double free attempt"; flow:to_client,established; dsize:17; content:"|01 02 00 00 00 00 00 04 02 00 00 00 00 00 00 00 02|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2014-0551; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32077; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player string concatenation memory corruption attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|00 0B 00|X|00|_global|00|s|00|A|00|str_n|00|n|00|prototype|00|pow2str"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0558; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-user; sid:32239; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player string concatenation memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|00 0B 00|X|00|_global|00|s|00|A|00|str_n|00|n|00|prototype|00|pow2str"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0558; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-user; sid:32238; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player string concatenation memory corruption attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"|F8 54 2C 1D B7 41 E9 47 FA BA 3B C8 2B 90 D2 D5 AC A4 50 84 4D 07 BE AD 28 A8 B6 41 A7 EF D1 51 F8 B9 84 84|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0558; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-user; sid:32237; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player string concatenation memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"|F8 54 2C 1D B7 41 E9 47 FA BA 3B C8 2B 90 D2 D5 AC A4 50 84 4D 07 BE AD 28 A8 B6 41 A7 EF D1 51 F8 B9 84 84|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0558; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-user; sid:32236; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player atomicCompareAndSwapLength integer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"atomicCompareAndSwapLength"; content:"casi32"; content:"|24 01 4F 0B 02 5D 0C 2F 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0569; reference:url,www.adobe.com/support/security/bulletins/apsb14-22.html; classtype:attempted-user; sid:32229; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player atomicCompareAndSwapLength integer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"atomicCompareAndSwapLength"; content:"casi32"; content:"|24 01 4F 0B 02 5D 0C 2F 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0569; reference:url,www.adobe.com/support/security/bulletins/apsb14-22.html; classtype:attempted-user; sid:32228; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player atomicCompareAndSwapLength integer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|74 DA 25 FE 65 D4 C9 59 13 3B 3F E6 0D D5 73 CC 06 F5 78 B1 93 9A 6F 9D F4 70 F0 ED 08 57 C0 57 9E 56 76 FC 88 F1 7A 75 CC B0 EC 8D 18 69 13 87|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0569; reference:url,www.adobe.com/support/security/bulletins/apsb14-22.html; classtype:attempted-user; sid:32227; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player atomicCompareAndSwapLength integer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|74 DA 25 FE 65 D4 C9 59 13 3B 3F E6 0D D5 73 CC 06 F5 78 B1 93 9A 6F 9D F4 70 F0 ED 08 57 C0 57 9E 56 76 FC 88 F1 7A 75 CC B0 EC 8D 18 69 13 87|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0569; reference:url,www.adobe.com/support/security/bulletins/apsb14-22.html; classtype:attempted-user; sid:32226; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"exp|06|RegExp|11|(?:(?1){1020}())?"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32308; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"exp|06|RegExp|11|(?:(?1){1020}())?"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32307; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|58 45 A1 66 AD 8E 1A 3B 36 C1 3D 05 04 39 8A EC 5C E6 82 42 2D 1B 03 32 8A 1C D5 70 AE 5A 2A 09 33 15 D8 B9 CD 04 84 5A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32306; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|58 45 A1 66 AD 8E 1A 3B 36 C1 3D 05 04 39 8A EC 5C E6 82 42 2D 1B 03 32 8A 1C D5 70 AE 5A 2A 09 33 15 D8 B9 CD 04 84 5A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32305; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|EF 40 CA C8 03 F4 11 94 77 22 65 E4 41 BA 17 94 BB 28 96 E7 21 8A 75 DA 4D 1F 45 FD 61 FA 18 D2 3D 74 1F D2 47 E8 7E A4|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32304; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|EF 40 CA C8 03 F4 11 94 77 22 65 E4 41 BA 17 94 BB 28 96 E7 21 8A 75 DA 4D 1F 45 FD 61 FA 18 D2 3D 74 1F D2 47 E8 7E A4|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32303; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|EC 2E E3 1F 26 F3 21 8E 46 53 3C A2 DE D1 CB 22 77 13 17 35 62 4E BD 27 26 23 DC 32 DB 8E BB 53 56 21 C1 AE FD 5F B3 AF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32302; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player regex denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|EC 2E E3 1F 26 F3 21 8E 46 53 3C A2 DE D1 CB 22 77 13 17 35 62 4E BD 27 26 23 DC 32 DB 8E BB 53 56 21 C1 AE FD 5F B3 AF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0564; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-22.html; classtype:attempted-dos; sid:32301; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player worker shared object user-after-free attempt"; flow:to_server,established; file_data; content:"|F2 B8 C7 C7 12 55 40 87 E7 59 C0 4E DF 21 AE E8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0502; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:32360; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player worker shared object user-after-free attempt"; flow:to_client,established; file_data; content:"|F2 B8 C7 C7 12 55 40 87 E7 59 C0 4E DF 21 AE E8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0502; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-07.html; classtype:attempted-user; sid:32359; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player HTML focus with no data denial of service attempt"; flow:to_server,established; file_data; content:"focus()"; nocase; content:"onfocusout="; within:15; nocase; content:"document.write("; within:20; nocase; content:"src="; within:30; nocase; content:".swf"; within:20; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-8441; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32545; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player HTML focus with no data denial of service attempt"; flow:to_client,established; file_data; content:"focus()"; nocase; content:"onfocusout="; within:15; nocase; content:"document.write("; within:20; nocase; content:"src="; within:30; nocase; content:".swf"; within:20; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-8441; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32544; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player compressed microphone object codec denial of service attempt"; flow:to_server,established; file_data; content:"|0A 71 8B 84 10 13 51 40 06 4C 1C A5 BF B5 1C 4A 6F 64 4E D0 E5 6D C5 71 66 99 97 6A 76 F5 4E 8D 77 C7 01 BD 18 8F 09 C0|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,71038; reference:cve,2014-0577; classtype:attempted-dos; sid:32543; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player compressed microphone object codec denial of service attempt"; flow:to_client,established; file_data; content:"|0A 71 8B 84 10 13 51 40 06 4C 1C A5 BF B5 1C 4A 6F 64 4E D0 E5 6D C5 71 66 99 97 6A 76 F5 4E 8D 77 C7 01 BD 18 8F 09 C0|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,71038; reference:cve,2014-0577; classtype:attempted-dos; sid:32542; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player decompressed microphone object codec denial of service attempt"; flow:to_server,established; file_data; content:"|96 02 00 08 8A 4E 96 02 00 08 8B 52 96 16 00 07 02 00 00 00 07 04 00 00 00 07 38 08 00 00 07 02 00 00 00 08 02 1C 96 02 00 08 40 4E 96 02 00 08 6C 4E 96 02 00 08 06 4E 96 02 00 08 8C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,71038; reference:cve,2014-0577; classtype:attempted-dos; sid:32541; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player decompressed microphone object codec denial of service attempt"; flow:to_client,established; file_data; content:"|96 02 00 08 8A 4E 96 02 00 08 8B 52 96 16 00 07 02 00 00 00 07 04 00 00 00 07 38 08 00 00 07 02 00 00 00 08 02 1C 96 02 00 08 40 4E 96 02 00 08 6C 4E 96 02 00 08 06 4E 96 02 00 08 8C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,71038; reference:cve,2014-0577; classtype:attempted-dos; sid:32540; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player AS3 regular expression grouping depth denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|EC E9 AE E9 50 93 D8 09 1E A3 3A E9 D0 CD 64 F2 52 D5 D0 AF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0581; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32539; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player AS3 regular expression grouping depth denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|DC EA 71 49 2D 6A DA 63 B5 D1 B5 6C 6A 39 11 36 43 A3 2D 1F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0581; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32538; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player AS3 regular expression grouping depth denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"(((((((("; content:"RegExp"; within:50; content:"match"; distance:0; nocase; content:"Object"; within:20; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0581; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32537; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player AS3 regular expression grouping depth denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|EC E9 AE E9 50 93 D8 09 1E A3 3A E9 D0 CD 64 F2 52 D5 D0 AF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0581; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32536; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player AS3 regular expression grouping depth denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|DC EA 71 49 2D 6A DA 63 B5 D1 B5 6C 6A 39 11 36 43 A3 2D 1F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0581; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32535; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player AS3 regular expression grouping depth denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"(((((((("; content:"RegExp"; nocase; content:"match"; within:50; nocase; content:"Object"; within:20; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0581; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-dos; sid:32534; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player string concatenation integer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.cws; content:"|9F 80 9D 01 1D 03 0E 2B D5 AB D7 A0 9E 6B A8 D0 6B 1D AB A8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,69700; reference:cve,2014-0550; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32576; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player string concatenation integer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.cws; content:"|77 D2 9A A4 EB 60 E5 F7 A2 D5 DC 4D 5B C8 6B 9F 24 76 36 0F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,69700; reference:cve,2014-0550; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32575; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player string concatenation integer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.swf; content:"MTASC_MAIN|00|this|00|AS2StringConcat"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,69700; reference:cve,2014-0550; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32574; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player string concatenation integer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.cws; content:"|9F 80 9D 01 1D 03 0E 2B D5 AB D7 A0 9E 6B A8 D0 6B 1D AB A8|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,69700; reference:cve,2014-0550; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32573; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player string concatenation integer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.cws; content:"|77 D2 9A A4 EB 60 E5 F7 A2 D5 DC 4D 5B C8 6B 9F 24 76 36 0F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,69700; reference:cve,2014-0550; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32572; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player string concatenation integer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.swf; content:"MTASC_MAIN|00|this|00|AS2StringConcat"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,69700; reference:cve,2014-0550; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32571; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malformed ATF header integer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|E3 FB 0E 95 B1 3C 9C A7 87 A3 C1 51 A8 05 37 55 DC D9 3F AA 8C 06 57 80 0C 1C 68 60 E3 3B 17 94|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0555; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32570; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malformed ATF header integer overflow attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|1D 01 62 04 24 00 4F 1D 01 D3 62 04 2D 01 26 4F 1E 03 47 00 00 03 02 01 01 08 23 D0 30 65 00 60|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0555; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32569; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malformed ATF header integer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|E3 FB 0E 95 B1 3C 9C A7 87 A3 C1 51 A8 05 37 55 DC D9 3F AA 8C 06 57 80 0C 1C 68 60 E3 3B 17 94|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0555; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32568; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malformed ATF header integer overflow attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|1D 01 62 04 24 00 4F 1D 01 D3 62 04 2D 01 26 4F 1E 03 47 00 00 03 02 01 01 08 23 D0 30 65 00 60|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0555; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-21.html; classtype:attempted-user; sid:32567; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player setglobalslot malformed bytecode remote code execution attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|07 6D 2D 01 2D 01 63 04 D3 30 D1 6F 01 D2 63 04 03 47 62 04 50 29 47 6D 02 65 01 D3 6D 03 65 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0584; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-user; sid:32561; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player setglobalslot malformed bytecode remote code execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|07 6D 2D 01 2D 01 63 04 D3 30 D1 6F 01 D2 63 04 03 47 62 04 50 29 47 6D 02 65 01 D3 6D 03 65 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0584; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-user; sid:32560; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player setglobalslot malformed bytecode remote code execution attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|70 A4 8B 52 A9 3F 4E B8 2B 23 41 C2 15 85 36 D9 06 53 CA AD F2 56 59 29 B5 4A 4A A3 D5 D8 6A 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0584; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-user; sid:32559; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player setglobalslot malformed bytecode remote code execution attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|70 A4 8B 52 A9 3F 4E B8 2B 23 41 C2 15 85 36 D9 06 53 CA AD F2 56 59 29 B5 4A 4A A3 D5 D8 6A 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0584; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:attempted-user; sid:32558; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash player incorrect codec denial of service attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|BF 03|"; content:"|01 00 8F|"; within:3; distance:4; content:"|68 00 F1 16 22 FC B8 0D F8 15 C4 3F E4 40 8F 1C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-0576; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:denial-of-service; sid:32553; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash player incorrect codec denial of service attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|BF 03|"; content:"|01 00 8F|"; within:3; distance:4; content:"|68 00 F1 16 22 FC B8 0D F8 15 C4 3F E4 40 8F 1C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-0576; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-24.html; classtype:denial-of-service; sid:32552; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player malformed JPEG information leak attempt"; flow:to_server,established; file_data; flowbits:isset,file.jpeg; content:"|76 2A 95 8A 96 E4 F9 A5 A4 10 4B 38 84 BE C3 A7 9F EF 1C 3B 35 41 3C 93 35 92 F3 07 26 0C 6A 48 58 0C 07 C2 42 F7 F7 16|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,69701; reference:cve,2014-0557; classtype:attempted-user; sid:32593; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player malformed JPEG information leak attempt"; flow:to_client,established; file_data; flowbits:isset,file.jpeg; content:"|76 2A 95 8A 96 E4 F9 A5 A4 10 4B 38 84 BE C3 A7 9F EF 1C 3B 35 41 3C 93 35 92 F3 07 26 0C 6A 48 58 0C 07 C2 42 F7 F7 16|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,69701; reference:cve,2014-0557; classtype:attempted-user; sid:32592; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-FLASH Adobe Flash Player byteArray.uncompress use after free attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|7C 7A AC 60 DB AB 45 67 76 74 D5 B2 98 DD 01 F4 44 26 CB BB 11 B3 19 1C 8F 99 82 97 ED 16|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:bugtraq,71048; reference:cve,2014-0588; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-28.html; classtype:attempted-user; sid:32669; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-FLASH Adobe Flash Player byteArray.uncompress use after free attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|7C 7A AC 60 DB AB 45 67 76 74 D5 B2 98 DD 01 F4 44 26 CB BB 11 B3 19 1C 8F 99 82 97 ED 16|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,71048; reference:cve,2014-0588; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-28.html; classtype:attempted-user; sid:32668; rev:1;)
